---
node_id: 518
title: ASP/.NET Integrated Mode on Cloud Sites
permalink: article/aspnet-integrated-mode-on-cloud-sites
type: article
created_date: '2011-03-16 21:57:40'
created_by: RackKCAdmin
last_modified_date: '2011-09-07 15:2109'
last_modified_by: matt.wheeler
products: Cloud Sites
categories: IIS and ASP.NET
body_format: tinymce
---

<p>The Rackspace Cloud provisions IIS sites in “Integrated Mode.” Running sites in Integrated Mode enhances application performance. However, if you encounter an issue with your ASP.NET site, please review the following potential errors.</p><p>If these potential solutions fail to correct the problem, please contact a member of our support team and they can assist in moving your site to a Classic App Pool.</p><p>ASP.NET applications require migration when specifying configuration in &lt;httpModules&gt; or &lt;httpHandlers&gt;.</p><p>You will receive a 500 - Internal Server Error. This can include HTTP Error 500.22, and HTTP Error 500.23: An ASP.NET setting has been detected that does not apply in Integrated managed pipeline mode.</p><p>It occurs because ASP.NET modules and handlers should be specified in the IIS &lt;handlers&gt; and &lt;modules&gt; configuration sections in Integrated Mode.</p><p>You can migrate by moving the custom entries in the &lt;system.web&gt;/&lt;httpModules&gt; and &lt;system.web&gt;/&lt;httpHandlers&gt; configuration manually to the &lt;system.webServer&gt;/&lt;handlers&gt; and &lt;system.webServer&gt;/&lt;modules&gt; configuration sections, and either removing the &lt;httpHandlers&gt; and &lt;httpModules&gt; configuration OR adding the following to your application’s web.config:</p><p>&lt;system.webServer&gt;</p><pre>  &lt;validation validateIntegratedModeConfiguration="false" /&gt;
</pre><p>&lt;/system.webServer&gt;</p><p><br /> Request URLs containing unencoded “+” characters in the path (not querystring) is rejected by default.</p><p>You will receive HTTP Error 404.11 – Not Found: The request filtering module is configured to deny a request that contains a double escape sequence.</p><p>This error occurs because IIS is by default configured to reject attempts to doubly-encode a URL, which commonly represent an attempt to execute a canonicalization attack.</p><p>Applications that require the use of the “+” character in the URL path can disable this validation by setting the allowDoubleEscaping attribute in the system.webServer/security/requestFiltering configuration section in the application’s web.config. However, this may make your application more vulnerable to malicious URLs:</p><p>&lt;system.webServer&gt;</p><pre>  &lt;security&gt;
          &lt;requestFiltering allowDoubleEscaping="true" /&gt;
  &lt;/security&gt;
</pre><p>&lt;/system.webServer&gt;</p><p><br /> Requests with querystrings larger then 2048 bytes will be rejected by default.</p><p>You will receive an HTTP Error 404.15 – Not Found: The request filtering module is configured to deny a request where the query string is too long.</p><p>IIS by default is configured to reject querystrings longer than 2048 bytes. This may affect your application if it uses large querystrings or uses cookieless ASP.NET features like Forms Authentication and others that cumulatively exceed the configured limit on the querystring size.</p><p>NOTE: This breaking change applies to both Classic and Integrated modes.</p><p>Increase the maximum querystring size by setting the maxQueryString attribute on the requestLimits element in the system.webServer/security/requestFiltering configuration section in your application’s web.config:</p><p>&lt;system.webServer&gt;</p><pre>  &lt;security&gt;
      &lt;requestFiltering&gt;
          &lt;requestLimits maxQueryString="NEW_VALUE_IN_BYTES" /&gt;
      &lt;/requestFiltering&gt;
  &lt;/security&gt;

</pre><p>&lt;/system.webServer&gt;</p><p><br /> DefaultHttpHandler is not supported. Applications relying on sub-classes of DefaultHttpHandler will not be able to serve requests.</p><p>If your application uses DefaultHttpHandler or handlers that derive from DefaultHttpHandler, it will not function correctly. In Integrated mode, handlers derived from DefaultHttpHandler will not be able to pass the request back to IIS for processing, and instead serve the requested resource as a static file. Integrated mode allows ASP.NET modules to run for all requests without requiring the use of DefaultHttpHandler.</p><p>Change your application to use modules to perform request processing for all requests, instead of using wildcard mapping to map ASP.NET to all requests and then using DefaultHttpHandler derived handlers to pass the request back to IIS.</p><p>Source: <a href="http://mvolo.com/blogs/serverside/archive/2007/12/08/IIS-7.0-Breaking-Changes-ASP.NET-2.0-applications-Integrated-mode.aspx" title="http://mvolo.com/blogs/serverside/archive/2007/12/08/IIS-7.0-Breaking-Changes-ASP.NET-2.0-applications-Integrated-mode.aspx" class="external free" rel="nofollow">http://mvolo.com/blogs/serverside/archive/2007/12/08/IIS-7.0-Breaking-Changes-ASP.NET-2.0-applications-Integrated-mode.aspx</a></p>
