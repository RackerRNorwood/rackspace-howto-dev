---
node_id: 4055
title: Rackspace Cloud Backup  - Install the agent on Windows
permalink: article/cloud-backup-support-agent-install-update-and-removal
type: article
created_date: '2014-05-01 18:57:19'
created_by: megan.meza
last_modified_date: '2015-10-15 19:4726'
last_modified_by: catherine.richardson
products: Cloud Backup
categories: Backups
body_format: tinymce
---

<p>The instructions in this article describe the procedure for the installation of the Rackspace Cloud Backup agent on your Windows server. If you are using a Linux server, see <a href="http://www.rackspace.com/knowledge_center/article/rackspace-cloud-backup-install-the-agent-linux" target="_self">Rackspace Cloud Backup&nbsp; - Install the Agent (Linux)</a> for the parallel instructions.</p>

<p>To update the agent, see the instructions in <a href="http://www.rackspace.com/knowledge_center/article/update-the-rackspace-cloud-backup-agent">Update the Rackspace Cloud Backup Agent.</a></p>

<table border="1">
	<tbody>
		<tr>
			<td><strong>CONTENTS</strong>

			<ul>
				<li><a href="#prerequisites">Requirements</a></li>
				<li><a href="#install">Installation</a></li>
				<li><a href="#update">Update</a></li>
				<li><a href="#troubleshooting">Troubleshooting</a></li>
				<li><a href="#uninstallwindows">Uninstall</a></li>
			</ul>
			</td>
		</tr>
	</tbody>
</table>

<p>&nbsp;</p>

<p><a name="prerequisites"></a></p>

<h2>Requirements</h2>

<p>Before installing the agent on a server, a new agent installation disconnects any previous registrations from that server. You must do a backup migration in order to re-associate the backup data from a disconnected registration. However, the old registration with its backup data remains attached to the customer account until it is deleted.</p>

<p><strong>Note:</strong> The Rackspace Cloud Backup agent requires .NET 4.0 or higher.<br />
&nbsp;</p>

<h2>Download the installer</h2>

<p><span>Determine whether your Windows server architecture is 64-bit or 32-bit, and download the latest MSI installation file for that architecture from</span><span>&nbsp;</span><a href="http://agentrepo.drivesrvr.com/">http://agentrepo.drivesrvr.com/</a><span>.</span></p>

<ul type="disc">
	<li><a href="http://97a6455ef60243cc8c74-57c93634a2c6eae60c16d098c741cf9b.r43.cf1.rackcdn.com/win32/driveclient-latest.msi">32-bit Windows .msi</a>&nbsp;</li>
	<li><a href="http://97a6455ef60243cc8c74-57c93634a2c6eae60c16d098c741cf9b.r43.cf1.rackcdn.com/win64/driveclient-latest.msi">64-bit Windows .msi</a>&nbsp;(This will almost always be the correct one for your server.)<br />
	&nbsp;</li>
</ul>

<h2><a name="install"></a>Installation</h2>

<p>You can choose one of the following methods of installation:</p>

<ul>
	<li><a href="#interactiveinstall" target="_self">Interactive</a></li>
	<li><a href="#silentinstall" target="_self">Silent</a></li>
	<li><a href="#update">Update</a><br />
	&nbsp;</li>
</ul>

<h3><a name="interactive"></a>Interactive installation</h3>

<p>Use the Windows package installer (<code>msiexec.exe</code>) to install the Cloud Backup agent in interactive mode. This command launches the Cloud Backup Setup Wizard. Enter this code at the Windows command line to begin interactive installation:</p>

<pre>
msiexec /i driveclient-1.18.007148-en-us.msi
</pre>

<p>You can also double-click on the MSI in order to start the interactive installation process. Follow the wizard instructions to complete the installation and configuration.</p>

<p><img alt="" border="1" height="266" src="/knowledge_center/sites/default/files/field/image/install-1.png" width="338" /></p>

<ol>
	<li>Read and accept the terms of the End-User License Agreement.
	<p><img alt="" border="1" height="267" src="/knowledge_center/sites/default/files/field/image/install-2.png" width="340" /></p>
	</li>
	<li>Start the Client Registration process by selecting API Key or Password option of registration. (For information about viewing your Rackspace API key, see <a href="http://www.rackspace.com/knowledge_center/article/view-and-reset-your-api-key">View and reset your API key.)</a>
	<p>To use the API Key option, you must install the Cloud Backup agent as the administrator account of your cloud server. Attempting to use the API Key option as a non-administrator will result in installation failure.</p>

	<p>Enter the User ID and the API Key or Password, depending on which option you choose. Click <strong>Next</strong>.</p>

	<p><img alt="" border="1" height="267" src="/knowledge_center/sites/default/files/field/image/install-3.png" width="340" /></p>
	</li>
	<li>Select the Datacenter and Flavor for your server.&nbsp;If you are not sure which data center or flavor to select, accept the option that the installer chose for you. Doing so is almost always the correct action to take. An exception would be the case of an OnMetal server. In this case, for instance, you would need to look up the datacenter for that server (typically IAD). Click <strong>Next</strong>.
	<p><img alt="" border="1" height="267" src="/knowledge_center/sites/default/files/field/image/install-5.png" width="340" /></p>

	<p>The installation process will continue.</p>
	</li>
	<li>Click <strong>OK</strong> when you see the <strong>SUCCESS!</strong> message.
	<p><img alt="" border="1" height="266" src="/knowledge_center/sites/default/files/field/image/install-6.png" width="337" /></p>
	</li>
	<li>Click <strong>Finish</strong> to complete the interactive installation.</li>
</ol>

<p>See <a href="#testsetup" target="_self">Test Windows installation or update</a> for the verification steps to test the installation.<br />
&nbsp;</p>

<h3><a name="silentinstall"></a>Silent installation</h3>

<p>See <a href="https://www.rackspace.com/knowledge_center/article/rackspace-cloud-backup-install-the-agent-on-windows-by-using-silent-installation">Rackspace Cloud Backup - Install the agent on Windows by using silent installation</a> to learn how to perform a silent installation.</p>

<p><strong>Note:</strong> The silent installation works only when you run it from the administrator account of the server.<br />
&nbsp;</p>

<h3><a name="update"></a>Update Cloud Backup agent on Windows</h3>

<p>For instructions to update the agent on Windows, see <a href="http://www.rackspace.com/knowledge_center/article/update-the-rackspace-cloud-backup-agent">Update the Rackspace Cloud Backup Agent.</a></p>

<p>&nbsp;</p>

<h2><a name="testsetup"></a></h2>

<h2>Test the Windows installation or update</h2>

<p>If you performed the silent or interactive installation, test the installation. If you performed the updated installation, test the update.</p>

<p>Verify that installation performed the following actions:</p>

<ol>
	<li>Created the <code>%programfiles%\driveclient</code> path.<br />
	&nbsp;</li>
	<li>Placed files in the <code>Program Files\driveclient</code> directory:
	<pre>
c:\&gt;dir "%programfiles%\driveclient" /a-d
Volume in drive C is OS
Volume Serial Number is EE4C-78FC
Directory of C:\Program Files\driveclient
10/05/2011 12:24 PM 5,749,760 driveclient.exe
03/01/2011 05:41 PM 1,693,696 icudt42.dll
03/01/2011 05:39 PM 1,289,216 icuuc42.dll
10/05/2011 01:37 PM 647,630 install.log
10/05/2011 01:37 PM 58,384 uninst.exe
5 File(s) 9,438,686 bytes</pre>
	</li>
	<li>Created the <code>%programdata%\driveclient</code> path.<br />
	&nbsp;</li>
	<li>Placed <code>bootstrap.json</code> in the <code>%programdata?%\driveclient</code> path, which looks as follows.
	<pre>
{
    "AccountId" : “991199”,
    "AgentId" : 119991,
    "AgentKey" : “ZLgIosvV558PXVlx+EKiT+2+sRtaSo+cI9BE1aY1W/73WRv8O8len56rjmeDoT0cnthAysW=",
    "ApiHostName" : "api.drivesrvr.com",
    "IsRegistered" : true,
    "Username" : “[yourusername]",
    "VolumePasswords" : [yourownveryverylongpasswordthatnoonecouldeverpossiblycrack]
}	</pre>
	Replace values in brackets with values that match your installation. The parameter provided with <code>/type=install</code> should be visible in the <code>bootstrap.json</code> file.<br />
	&nbsp;</li>
	<li>Created a DriveClientSvc service:
	<pre>
c:\&gt;sc query DriveClient
SERVICE_NAME: DriveClientSvc
TYPE : 10 WIN32_OWN_PROCESS
STATE : 1 STOPPED
WIN32_EXIT_CODE : 0 (0x0)
SERVICE_EXIT_CODE : 0 (0x0)
CHECKPOINT : 0x0
WAIT_HINT : 0x0</pre>
	</li>
	<li>Created the entry driveclient.exe in Control Panel &gt; Programs &gt; Programs and Features.<br />
	&nbsp;</li>
</ol>

<h2>Test the Windows update</h2>

<p>Run <code>driveclient-setup-latest.exe</code> to show any updated files in <code>program files\driveclient</code>.<br />
This is the same as running the setup with no parameters.</p>

<pre>
c:\&gt;dir "%programfiles%\driveclient\driveclient.exe"
Volume in drive C is OS
Volume Serial Number is EE4C-78FC
Directory of C:\Program Files\driveclient
10/05/2011 12:24 PM 5,749,760 driveclient.exe
1 File(s) 5,749,760 bytes
0 Dir(s) 449,822,932,992 bytes free</pre>

<p>&nbsp;</p>

<h2><a name="troubleshooting"></a>Troubleshooting installs, upgrades, and uninstalls</h2>

<p><strong>Note:</strong>The silent installation method will fail without a clear error message if it is run as a non-administrator. If the silent installation fails, run the <a href="interactive"> interactive installation</a>.</p>

<p>If the Cloud Backup agent installation is unsuccessful, look at the Windows Event log for any errors, or look at the <code>msiexec</code> installation log for diagnostics regarding an unsuccessful installation.</p>

<p>For details about an agent that fails to register or fails to start on installation, look at <code>C:\ProgramData\Driveclient\log\driveclient.log</code>.</p>

<p>We recommend that you enable TRACE logging as part of the troubleshooting process. Should you need to call the Support team, TRACE logging will help them identify the problem. For more information about TRACE logging, see <a href="/knowledge_center/article/cloud-backup-agent-logging-basics">Cloud Backup agent logging basics</a>.</p>

<p>If the agent fails to start up, e.g., registration failure, etc., the most effective log setting is to directly edit the <code>log4cxx.xml</code> file .</p>

<p>A Cloud Backup connection error indicates that the agent is not running on your server. In this case, verify that your firewall isn't blocking outgoing connections on port 443.<br />
&nbsp;</p>

<h3>Backup statuses - skipped, missed, errored, and failed</h3>

<p>The backup statuses are defined below:</p>

<ul>
	<li>Skipped: The backup job was skipped because a backup job was already queued. A single backup job can be queued only once.</li>
	<li>Missed: The backup job was missed because the agent did not respond. The agent was likely offline.</li>
	<li>Errored: An error occurred during the backup. The backup job did run, but it needs to be investigated.</li>
	<li>Failed: A serious problem occurred, and the backup job did not run.</li>
</ul>

<p>Follow these procedures to troubleshoot the skipped, missed, errored, and failed statuses:</p>

<ul>
	<li>
	<p>Skipped: This error likely occurs because the frequency of the backup job is set too high. Consider reducing the frequency of the job, or reducing the amount of data. If this is the initial job, then the subsequent jobs might finish faster.</p>
	</li>
	<li>
	<p>Missed: Verify that the agent is running on the server. If the agent is not already running, then start it. Next, check the logs to determine why the backup job failed. An agent should never go offline by itself. Either a software exception occurred or the agent was manually terminated.</p>
	</li>
	<li>
	<p>Errored: Look in the logs on the server. The agent stores all the logs in one location (see the following section). Review the logs line by line. If you cannot determine the cause of the error, raise a ticket with the SME group, and they can help you identify the problem.</p>
	</li>
	<li>
	<p>Failed: As with the Errored status, check the logs on the server. A failed status is severe.</p>
	</li>
</ul>

<p>&nbsp;</p>

<h2><a name="uninstallwindows"></a>Uninstall Cloud Backup agent on Windows</h2>

<p>To uninstall the Cloud Backup agent, the preferred method is to uninstall using the Windows Control Panel. However, you can also use msiexec from the command line.</p>

<pre>
msiexec /x driveclient-1.18.007148-en-us.msi /qn /l*v %tmp%\uninstall-1.18.007148.log
                </pre>

<p>Run <code>%programfiles%\driveclient\uninst.exe</code>.<br />
<br />
The following changes should occur:</p>

<ul>
	<li>The path %programfiles%\driveclient contains a single file: <code>install.log</code>

	<pre>
c:\&gt;dir "%programfiles%\driveclient" /a-d
Volume in drive C is OS
Volume Serial Number is EE4C-78FC
Directory of C:\Program Files\driveclient
10/05/2011 01:29 PM 607,013 install.log
1 File(s) 607,013 bytes
2 Dir(s) 449,805,914,112 bytes free</pre>
	</li>
	<li>The %programdata%\driveclient path does not exist.
	<pre>
c:\&gt;dir "%programdata%\driveclient"
Volume in drive C is OS
Volume Serial Number is EE4C-78FC
Directory of C:\ProgramData
File Not Found</pre>
	</li>
	<li>No driveclient.exe entry exists in Control Panel &gt; Programs and Features.</li>
	<li>No DriveClientSvc service is installed.
	<ul>
		<li>
		<ul>
			<li>There should be no scheduled tasks to "check for driveclient update."</li>
		</ul>
		</li>
	</ul>

	<pre>
c:\&gt;sc query driveclientsvc
[SC] EnumQueryServicesStatus:OpenService FAILED 1060:
The specified service does not exist as an installed service.
</pre>
	</li>
</ul>

<p>&nbsp;</p>

<h2><a id="uninstallwindows" name="uninstallOLDwindows"></a>Uninstall the agent from older versions of Windows</h2>

<p><strong>Note</strong>: Complete the following steps <strong>ONLY</strong> if unistalling the agent from Window's agent version 1.18 or lower. You can check your agent version by logging into your Cloud Control Panel, clicking on the "Backup" tab, and selecting your backup system. The version number is listed under <em>System Details. </em>If your version is higher than 1.18, see the previous section, <a href="#uninstallwindows">Uninstall Cloud Backup Agent on Windows</a> for your uninstall.</p>

<p>To proceed for versions 1.18 or lower, run <code>%programfiles%\driveclient\uninst.exe</code>.</p>

<p>The following changes should occur:</p>

<ul>
	<li>The path <code>%programfiles%\driveclient</code> contains a single file: install.log</li>
</ul>

<pre>
c:\&gt;dir %programfiles%\driveclient /a-d
 Volume in drive C is OS
 Volume Serial Number is EE4C-78FC
 Directory of C:\Program Files\driveclient
10/05/2011  01:29 PM           607,013 install.log
              1 File(s)        607,013 bytes
               2 Dir(s)  449,805,914,112 bytes free
</pre>

<ul>
	<li>The %programdata%\driveclient path does not exist.</li>
</ul>

<pre>
c:\&gt;dir "%programdata%\driveclient"
 Volume in drive C is OS
 Volume Serial Number is EE4C-78FC

 Directory of C:\ProgramData

File Not Found
</pre>

<ul>
	<li>No driveclient.exe entry exists in Control Panel &gt; Programs and Features.</li>
	<li>No DriveClientSvc service is installed.</li>
	<li>There should be no scheduled tasks to "check for driveclient update".
	<pre>
c:\&gt;sc query driveclientsvc
[SC] EnumQueryServicesStatus:OpenService FAILED 1060:

The specified service does not exist as an installed service.</pre>
	</li>
</ul>

<p>&nbsp;</p>
