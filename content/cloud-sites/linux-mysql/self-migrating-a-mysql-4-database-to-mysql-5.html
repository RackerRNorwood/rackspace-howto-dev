---
node_id: 1224
title: Self-Migrating a MySQL 4 Database to MySQL 5
permalink: article/self-migrating-a-mysql-4-database-to-mysql-5
type: article
created_date: '2011-10-05 14:32:41'
created_by: RackKCAdmin
last_modified_date: '2011-10-06 15:0358'
last_modified_by: matt.wheeler
products: Cloud Sites
categories: Linux MySQL
body_format: tinymce
---

<p>Cloud Sites will be retiring MySQL 4 soon in favor of MySQL 5.  Any sites using MySQL 4 after November 1, 2011, will be automatically migrated to MySQL 5.</p>

<p>Migrating affected sites between MySQL versions will of necessity involve some site downtime. Our automated process is designed to minimize the downtime and impact of the change, but performing the migration yourself in advance of the cut-off date will give you control over the timing and presentation of your site during the process.</p>

<p>The following steps walk through the process of manually migrating a MySQL 4 database to a MySQL 5 database.</p>

<ol>
  <li>
    <p><strong>Begin by putting a splash page up for your site stating that you are performing maintenance.</strong></p>
  </li>

  <li>
    <p><strong>Revoke all user access to the database to prevent changes during the migration.</strong></p>

    <p>You can revoke access by using your administrative access to rename the config file that contains your database link information to a filename with the ".mig" extension.</p>

    <p>For example, the file:</p>
    <pre>config.php
</pre>

    <p>...would be renamed to:</p>
    <pre>config.php.mig
</pre>
  </li>

  <li>
    <p><strong>Once the filename is changed you can either wait for user transactions to complete normally or terminate them manually.</strong></p>

    <p>To check for active transactions use the SQL command:</p>
    <pre>SHOW FULL PROCESSLIST
</pre>

    <p>You can see more information about listing the processes in the MySQL manual <a class="xref" href="http://dev.mysql.com/doc/refman/5.0/en/show-processlist.html">Section 12.4.5.27, "<samp>SHOW FULL PROCESSLIST</samp>Syntax"</a>.</p>

    <p>If you don't want to wait for active connections to conclude, those threads can be killed with the MySQL<samp>KILL</samp>statement. For more details on<samp>KILL</samp>, see the MySQL Manual <a class="xref" href="http://dev.mysql.com/doc/refman/5.0/en/kill.html">Section 12.4.6.3, "<samp>KILL</samp>Syntax"</a>.</p>
  </li>

  <li>
    <p><strong>Back up your current MySQL 4 database.</strong></p>

    <p>You may wish to use the method outlined in the Knowledge Center article <a class="xref" href="http://www.rackspace.com/knowledge_center/index.php/How_to_backup_your_MySQL_database_with_phpMyAdmin">How to backup your MySQL Database with phpMyAdmin</a>.</p>
  </li>

  <li>
    <p><strong>Provision a new MySQL 5 database to contain the migrated database.</strong></p>

    <p>For a guide to provisioning a new MySQL 5 database, see the Knowledge Center article <a class="xref" href="http://www.rackspace.com/knowledge_center/index.php/Adding_a_MySQL_Database_to_a_Website_or_Domain">Adding a MySQL Database to a Website or Domain</a>.</p>
  </li>

  <li>
    <p><strong>Import your database into the newly-provisioned MySQL 5 database.</strong></p>

    <p>Databases that are less than 16 MB in size can be imported easily using the <em>Online Manager</em> (see <a class="xref" href="http://www.rackspace.com/knowledge_center/index.php/Working_with_a_MySQL_database">Working with a MySQL database</a>).</p>

    <p>If the data to be imported exceeds 16 MB, follow the suggestions in the Knowledge Center article <a class="xref" href="http://www.rackspace.com/knowledge_center/index.php/How_do_I_import_a_large_Mysql_Database">How do I import a large MySQL Database</a>.</p>
  </li>

  <li>
    <p><strong>Update all database references in your website code and configuration files.</strong></p>

    <p>Look for any references to the old database's host name, IP address, username and password data. Replace those entries with the newly-provisioned database's values.</p>
  </li>

  <li>
    <p><strong>Remove the .mig extension from your config file's name.</strong></p>

    <p>Assuming your new user information is valid the site should begin processing against the new database in the same manner as before.</p>
  </li>
</ol>

<p>This process can take a little while to complete. If your website has been provisioned in excess of 15 minutes and you are still experiencing a problem please do not hesitate to contact our technical support 24x7 via phone, chat or by submitting a ticket through your control panel.</p>
