---
node_id: 502
title: VNC Install
permalink: article/vnc-install
type: article
created_date: '2011-03-16 21:57:40'
created_by: RackKCAdmin
last_modified_date: '2013-04-17 21:5004'
last_modified_by: jered.heeschen
products: Cloud Servers
categories: Remote Access
body_format: tinymce
---

<p>This page explains how to install VNC on your Cloud Server. This article was based upon the CentOS 5 distribution. This tutorial assumes you have root access to your server and are running on a clean installation.</p><p><strong>Note: In order to use this you must have at least 512MB of RAM or X Windows will not run. </strong></p><p><strong>WARNING: Running VNC on your Cloud Server will consume large amounts of bandwidth. Please use wisely!</strong></p><p>If you would like information about tunnelling VNC over SSH please visit <a class="external free" title="http://martybugs.net/smoothwall/puttyvnc.cgi" href="http://martybugs.net/smoothwall/puttyvnc.cgi" rel="nofollow">http://martybugs.net/smoothwall/puttyvnc.cgi</a></p><hr /><table id="toc" class="toc" summary="Contents"><tbody><tr><td><div id="toctitle"><h2>Contents</h2></div><ul><li class="toclevel-1"><a href="#Install_the_Necessary_Packages"><span class="tocnumber">1</span> <span class="toctext">Install the Necessary Packages</span></a><ul><li class="toclevel-2"><a href="#Install_Perl"><span class="tocnumber">1.1</span> <span class="toctext">Install Perl</span></a></li><li class="toclevel-2"><a href="#Install_X_Windows"><span class="tocnumber">1.2</span> <span class="toctext">Install X Windows</span></a></li><li class="toclevel-2"><a href="#Install_a_Window_Manager"><span class="tocnumber">1.3</span> <span class="toctext">Install a Window Manager</span></a><ul><li class="toclevel-3"><a href="#KDE"><span class="tocnumber">1.3.1</span> <span class="toctext">KDE</span></a></li><li class="toclevel-3"><a href="#GNOME"><span class="tocnumber">1.3.2</span> <span class="toctext">GNOME</span></a></li><li class="toclevel-3"><a href="#TWM"><span class="tocnumber">1.3.3</span> <span class="toctext">TWM</span></a></li></ul></li><li class="toclevel-2"><a href="#Install_VNC_Server"><span class="tocnumber">1.4</span> <span class="toctext">Install VNC Server</span></a></li></ul></li><li class="toclevel-1"><a href="#Configuration"><span class="tocnumber">2</span> <span class="toctext">Configuration</span></a><ul><li class="toclevel-2"><a href="#Configure_VNC"><span class="tocnumber">2.1</span> <span class="toctext">Configure VNC</span></a></li><li class="toclevel-2"><a href="#Firewall"><span class="tocnumber">2.2</span> <span class="toctext">Firewall</span></a></li><li class="toclevel-2"><a href="#Test_the_Server"><span class="tocnumber">2.3</span> <span class="toctext">Test the Server</span></a><ul><li class="toclevel-3"><a href="#Switch_to_your_User"><span class="tocnumber">2.3.1</span> <span class="toctext">Switch to your User</span></a></li><li class="toclevel-3"><a href="#Create_a_.vnc_directory"><span class="tocnumber">2.3.2</span> <span class="toctext">Create a .vnc directory</span></a></li><li class="toclevel-3"><a href="#Create_the_xstartup_file"><span class="tocnumber">2.3.3</span> <span class="toctext">Create the xstartup file</span></a></li><li class="toclevel-3"><a href="#Setup_your_VNC_user"><span class="tocnumber">2.3.4</span> <span class="toctext">Setup your VNC user</span></a></li><li class="toclevel-3"><a href="#Start_the_VNC_server"><span class="tocnumber">2.3.5</span> <span class="toctext">Start the VNC server</span></a></li><li class="toclevel-3"><a href="#Connect_to_your_VNC"><span class="tocnumber">2.3.6</span> <span class="toctext">Connect to your VNC</span></a></li><li class="toclevel-3"><a href="#Stopping_the_VNC_Server"><span class="tocnumber">2.3.7</span> <span class="toctext">Stopping the VNC Server</span></a></li></ul></li></ul></li></ul></td></tr></tbody></table><p><a id="Install_the_Necessary_Packages" name="Install_the_Necessary_Packages"></a></p><h2><span class="mw-headline">Install the Necessary Packages </span></h2><p>This article will assume you know how to use the YUM (YUM Update Manager) from the <a title="CentOS - Setup" href="/knowledge_center/index.php/CentOS_-_Setup">CentOS - Setup</a> article.</p><p><a id="Install_Perl" name="Install_Perl"></a></p><h3><span class="mw-headline">Install Perl </span></h3><pre># yum install perl
</pre><p><a id="Install_X_Windows" name="Install_X_Windows"></a></p><h3><span class="mw-headline">Install X Windows </span></h3><p>We will need to install the X-Windows platform to run the graphical portion of this project. X11 is a graphical display server, and will server and will sit above the Window Manager.</p><p>To install run the following as root:</p><pre># yum groupinstall "X Window System"

</pre><p><a id="Install_a_Window_Manager" name="Install_a_Window_Manager"></a></p><h3><span class="mw-headline">Install a Window Manager </span></h3><p><a class="external text" title="http://www.kde.org/" href="http://www.kde.org/" rel="nofollow">KDE</a>, <a class="external text" title="http://www.gnome.org./" href="http://www.gnome.org./" rel="nofollow">GNOME</a> and <a class="external text" title="http://xwinman.org/vtwm.php" href="http://xwinman.org/vtwm.php" rel="nofollow">TWM</a> are all Window Managers and are the human usable layer that you are probably familiar with. This gives you the access to use a mouse and send calls to the X11 server.</p><p><a id="KDE" name="KDE"></a></p><h4><span class="mw-headline">KDE </span></h4><pre># yum groupinstall "KDE Desktop"
</pre><p>Also, this may be needed:</p><pre># yum install kde-session</pre><p><a id="GNOME" name="GNOME"></a></p><h4><span class="mw-headline">GNOME </span></h4><pre># yum groupinstall "GNOME Desktop Environment"

</pre><p>Also, this may be needed:</p><pre># yum install gnome-session</pre><p><a id="TWM" name="TWM"></a></p><h4><span class="mw-headline">TWM </span></h4><p>TWM is the default X-Window Manager and you don't have to install any additional packages, it is light and will run on almost anything, but is also not very user friendly and almost requires a power-user.</p><p><a id="Install_VNC_Server" name="Install_VNC_Server"></a></p><h3><span class="mw-headline">Install VNC Server </span></h3><p>VNC is the service that display your X output to a tcp connection over the internet.</p><pre># yum install vnc-server
</pre><p><a id="Configuration" name="Configuration"></a></p><h2><span class="mw-headline">Configuration </span></h2><p><a id="Configure_VNC" name="Configure_VNC"></a></p><h3><span class="mw-headline">Configure VNC </span></h3><ul><li>Modify the <strong>/etc/sysconfig/vncservers</strong> configuration file by performing the following commands:</li></ul><pre># nano /etc/sysconfig/vncservers
</pre><p>Insert the following lines into the file:</p><pre>VNCSERVERS="1:someguy"
VNCSERVERARGS[1]="-geometry 800x600 -depth 16"
</pre><p>This will create a VNC session for one user with the username of <strong>someguy</strong>. If you would like to setup multiple users you will need to add additional users to that line. For example...</p><pre>1:someguy 2:someperson 3:somegirl
</pre><p>You will also need to add additional VNCSERVERARGS lines to correspond to each user. Change the [1] to match the session number.</p><p><a id="Firewall" name="Firewall"></a></p><h3><span class="mw-headline">Firewall </span></h3><p>If you have a firewall running, you will need to open port 5901. For example, on CentOS, run:</p><pre># iptables -I INPUT 1 -p tcp --dport 5901 -j ACCEPT
</pre><p>If needed, replace 5901 with a range, depending on the number of sessions required (e.g. 5901:5905).</p><p>Save the new iptables rule:</p><pre># service iptables save</pre><p><a id="Test_the_Server" name="Test_the_Server"></a></p><h3><span class="mw-headline">Test the Server </span></h3><p><a id="Switch_to_your_User" name="Switch_to_your_User"></a></p><h4><span class="mw-headline">Switch to your User </span></h4><pre># su username
$ cd ~
</pre><p><a id="Create_a_.vnc_directory" name="Create_a_.vnc_directory"></a></p><h4><span class="mw-headline">Create a .vnc directory </span></h4><p><em>take note of the '.' in front of the name</em></p><pre>$ mkdir .vnc
$ cd .vnc
</pre><p><a id="Create_the_xstartup_file" name="Create_the_xstartup_file"></a></p><h4><span class="mw-headline">Create the xstartup file </span></h4><p>Insert the configuration below (this is for a KDE-VNC session):</p><pre>#!/bin/sh
unset SESSION_MANAGER
exec /etc/X11/xinit/xinitrc
[ -x /etc/vnc/xstartup ] &amp;&amp; exec /etc/vnc/xstartup
[ -r $HOME/.Xresources ] &amp;&amp; xrdb $HOME/.Xresources
xsetroot -solid grey
vncconfig -iconic &amp;
xterm -geometry 80x24+10+10 -ls -title "$VNCDESKTOP Desktop" &amp;

startx &amp;
exec kde-session &amp;
</pre><ul><li>If you are using GNOME, change 'kde-session' to 'gnome-session'</li></ul><p>Make the file executable:</p><pre>$ chmod u+x xstartup
</pre><p><a id="Setup_your_VNC_user" name="Setup_your_VNC_user"></a></p><h4><span class="mw-headline">Setup your VNC user </span></h4><p>Set the user's private VNC connection password</p><pre># vncpasswd
</pre><ul><li>You will be required to confirm your password.</li></ul><p><a id="Start_the_VNC_server" name="Start_the_VNC_server"></a></p><h4><span class="mw-headline">Start the VNC server </span></h4><p>Make sure you exit out of your user session and go back to 'root'.</p><p>start the server:</p><pre># service vncserver start

</pre><ul><li>You may see some error messages here stating 'unexpected EOF' or syntax errors -- these are normal. If you see <strong>[ OK ]</strong> then the service has started properly.</li></ul><p><a id="Connect_to_your_VNC" name="Connect_to_your_VNC"></a></p><h4><span class="mw-headline">Connect to your VNC </span></h4><p>Open up your VNC client and type in your external IP address, colon, then your session ID configured in <strong>/etc/sysconfig/vncservers</strong>. The session number must correspond to the user name or it will not connect.</p><p>Example: 64.25.25.25:1</p><ul><li>Type in the password you chose with vncpasswd and you will be connected.</li></ul><p><br /> To close the connection simple close the window.</p><p><a id="Stopping_the_VNC_Server" name="Stopping_the_VNC_Server"></a></p><h4><span class="mw-headline">Stopping the VNC Server </span></h4><p>To stop the VNC server type the following:</p><pre># service vncserver stop
</pre><p><a class="new" title="User:Kkoehn (page does not exist)" href="/knowledge_center/index.php?title=User:Kkoehn&amp;action=edit&amp;redlink=1">Kelly Koehn</a> 14:24, 17 March 2009 (CDT)</p>
