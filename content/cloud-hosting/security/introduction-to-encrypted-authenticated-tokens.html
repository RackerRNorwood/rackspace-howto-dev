---
node_id: 4766
title: Introduction to encrypted authenticated tokens
permalink: article/introduction-to-encrypted-authenticated-tokens
type: article
created_date: '2015-07-28 21:49:18'
created_by: constanze.kratel
last_modified_date: '2015-10-13 17:0405'
last_modified_by: catherine.richardson
products: Cloud Hosting
categories: Security
body_format: tinymce
---

<p><a id="top" name="top"></a>Rackspace Cloud Identity supports tokens of different&nbsp;<em>types</em>&nbsp;and&nbsp;<em>formats</em>&nbsp;to enable a user to authenticate against a specific Rackspace Cloud service.</p>

<ul>
	<li>The token&nbsp;<em>type</em>&nbsp;specifies whether the user is provisioned or federated.</li>
	<li>The token&nbsp;<em>format</em>&nbsp;specifies the composition of the token itself.</li>
</ul>

<p>Rackspace Cloud Identity has switched&nbsp;the authentication token format from UUID to Authenticated Encryption (AE). Rackspace engineers have&nbsp;implemented the new token format on the Identity system back end.&nbsp;The change has minimal impact to Rackspace customers.&nbsp;The main difference that you will notice is that&nbsp;the authentication token value returned by the Identity service has a different pattern and length than the UUID token values issued previously.&nbsp;<br />
<br />
<strong>Note:</strong>&nbsp; Make sure that you follow <a href="#Best practices for handling authentication tokens">Best practices for handling authentication tokens</a>, especially if you use SDK or CLI tools to interact with the Rackspace Cloud.</p>

<p>This article explains the two different token formats and provides best practices for working with authentication tokens in general.</p>

<ul>
	<li><a href="#What are AE tokens">What is an AE token?</a></li>
	<li><a href="#What are UUID tokens">What is a UUID token?</a></li>
	<li><a href="#Difference between UUID and AE tokens">What is the difference between UUID and AE tokens?</a></li>
	<li><a href="#Best practices for handling authentication tokens">Best practices for handling authentication tokens</a></li>
</ul>

<h2><a id="What are AE tokens" name="What are AE tokens"></a>What is an AE token?</h2>

<p>An AE token is generated by using Authenticated&nbsp;Encryption. Authenticated encryption specifies a way to secure a message so that others cannot fake it, change it, or read it.</p>

<p>Authenticated encryption is used to generate&nbsp;<em>non-persistent</em>&nbsp;tokens for user authentication. An AE token contains all the necessary data to determine whether a given token is valid, instead of pointing to this data. With AE tokens, all the metadata is encrypted within the token itself. Because AE tokens contain all the relevant data, there is no need to the store tokens in persistent storage. When the server receives the token, it can parse the token metadata to determine if it is valid.</p>

<p>Because of encryption, the size of an AE-formatted token varies. The Rackspace Cloud Identity service limits the size of AE-formatted tokens to 250 bytes.</p>

<p>The following example shows a token object from the authentication response with an AE token ID.</p>

<pre>
"token": {
      "id": "ABCDEF7RbnU-LLWJ1J8PeHRGMz2Cf3rPUG_a25hQRWTcL7tH231H7ubr6y1EkRi_curq6PqJV-pCiIADZrwFtCexcy9MVO3eckgGWqDqnxvXaUMF7XA_reFwwp3pNu_7p9uXofGmiueccwrA",
      "expires": "2015-08-20T23:51:19.055Z",
       "tenant": {
       "id": "123456",
       "name": "123456"
         }
</pre>

<h2><a id="What are UUID tokens" name="What are UUID tokens"></a>What is a UUID token?</h2>

<p>Authentication tokens that use the UUID token format are&nbsp;<em>persistent</em>&nbsp;tokens. When a user authenticates successfully, the Rackspace Cloud Identity service generates a 32 character UUID token value. It is stored&nbsp;in a persistent storage unit on the back end along with metadata about that token such as expiration time stamp, who the token is issued to, and so on. The token value is returned to the user so that it can be included in subsequent requests to Rackspace Cloud services to confirm identity.&nbsp;&nbsp;</p>

<p>When the user submits a request with the token, the Identity service validates the token value against the data that is stored in the persistent storage to confirm that the user is authorized to perform the operation. When a UUID token expires, the user must re-authenticate. Then, the Identity service issues a new token and also deletes the expired token from the persistent backend storage unit.</p>

<p>The following example shows a token object from the authentication response with a UUID token id.</p>

<pre>
"token": {
      "id": "b726839ca0fd4d9ead8edbb73f123456",
      "expires": "2015-08-20T23:48:50.793Z",
      "tenant": {
      "id": "123456",
      "name": "123456"
         }
</pre>

<h2><a id="Difference between UUID and AE tokens" name="Difference between UUID and AE tokens"></a>What is the difference between UUID and AE tokens?</h2>

<p>UUID and AE tokens differ in their persistence, length, and storage.</p>

<ul>
	<li>UUID tokens are&nbsp;<em>persistent.&nbsp;</em>AE tokens are&nbsp;<em>non-persistent</em>. With a UUID token, you receive a token when you authenticate. That token persists in back-end storage for 24-hours and the same value is returned each time you authenticate until the token expires. With AE tokens, the value is non-persistent, which means that the value is not stored on the backend, and the Identity service generates and returns a new token value each time the user authenticates.</li>
	<li>UUID tokens&nbsp;are 32 characters in length.&nbsp;AE tokens vary in size but for the Rackspace Cloud Identity service they are limited to 250 bytes. With the implementation of AE tokens, you will notice that the token value returned when you authenticate is significantly longer than the value returned when the Identity service issued UUID tokens.</li>
	<li>UUID tokens are stored in the Identity service back-end along with the metadata for authentication.&nbsp;&nbsp;AE tokens provide the required authentication metadata within the encrypted token value. The Identity service does not store the AE token value in the back-end system.</li>
</ul>

<h2><a id="Best practices for handling authentication tokens" name="Best practices for handling authentication tokens"></a>Best practices for handling authentication tokens</h2>

<p>Following are some best practices for handling authentication tokens. &nbsp;</p>

<ul>
	<li>When you authenticate to the Rackspace Cloud Identity service be sure to cache the token value that is returned.&nbsp;<br />
	<br />
	The Rackspace Cloud Identity service validates the authentication token in every API request before attempting to complete the operation. To optimize your API operations and reduce system load, store the authentication token in a secure cache or database so that applications can use the stored value instead of requiring the application to issue an authentication request before each API operation. You can reuse the cached token value as long as it remains valid.<br />
	<br />
	<strong>Note:</strong> For an example of how to cache credentials with an SDK, see <a href="http://php-opencloud.readthedocs.org/en/latest/caching-creds.html">Caching credentials</a>&nbsp;in the php-opencloud&nbsp;documentation.<br />
	&nbsp;</li>
	<li>Design applications to reauthenticate after receiving a&nbsp;<code class="code">401 Unauthorized</code>&nbsp;response from a service endpoint, or to check the token expiration and reauthenticate before the token expires.<br />
	&nbsp;</li>
	<li>To simplify authentication, credential, and token management, use an&nbsp;<a class="link" href="https://wiki.openstack.org/wiki/OpenStackClients" target="_top">OpenStack command-line client application</a>&nbsp;or one of the&nbsp;<a class="link" href="https://developer.rackspace.com/sdks/" target="_top">Rackspace SDKs</a>.</li>
</ul>

<p>For more information, read the&nbsp;<a href="http://docs.rackspace.com/auth/api/v2.0/auth-client-devguide/content/QuickStart-000.html#manage_auth_tokens">Manage authentication tokens</a>&nbsp;section in the&nbsp;<a href="http://docs.rackspace.com/auth/api/v2.0/auth-client-devguide/content/QuickStart-000.html">Rackspace Cloud Identity Client Developer Guide</a>.</p>

<p>&nbsp;</p>
