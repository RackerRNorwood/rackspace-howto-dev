---
node_id: 3999
title: Create a maintenance backup plan in SQL Server 2008 R2 using the wizard
permalink: article/create-maintenance-backup-plan-in-sql-server-2008-r2-using-the-wizard
type: article
created_date: '2014-04-04 21:04:58'
created_by: kyle.laffoon
last_modified_date: '2014-04-10 16:3905'
last_modified_by: kyle.laffoon
products: Cloud Backup
categories: Backups
body_format: tinymce
---

<p>When you create a maintenance backup plan in SQL Server 2008 R2, you must identify how you want the plan to be set up. In this example, the maintenance plan is set up with full backups, differentials, and transactions logs.</p><p>This process has the following steps:</p><ul><li><a href="#checksqlserveragentservice" target="_self">Check the SQL Server Agent service</a></li><li><a href="#createmaintenanceplan" target="_self">Create the maintenance plan</a></li><li><a href="#fullbackupsettings" target="_self">Full backup settings</a></li><li><a href="#differentialbackupsettings" target="_self">Define differential backup Settings</a></li><li><a href="#transactionlogbackupsettings" target="_self">Define transaction log backup settings</a></li><li><a href="#transactionlogcleanup" target="_self">Set up the transaction log cleanup task</a></li><li><a href="#testsetup" target="_self">Test your setup</a></li><li><a href="#errors" target="_self">Troubleshoot errors by viewing the job history</a></li></ul><h2><a name="checksqlserveragentservice"></a>Check SQL Server Agent service</h2><p>Verify that the SQL Server Agent service is running and set to automatic. The maintenance plan depends on this service to run.</p><ol><li>On the server, open the <strong>Run</strong> dialog box, type in <strong>services.msc</strong> and press <strong>Enter</strong>. <br /> <br /> <img src="/knowledge_center/sites/default/files/field/image/CheckSQLServerAgent1.png" alt="" width="429" height="225" border="2" /></li><li>Find the SQL Server Agent service in the list and double-click it. <br /> <br /> <img src="/knowledge_center/sites/default/files/field/image/CheckSQLServerAgent2.png" alt="" width="727" height="321" border="2" /></li><li>Cick the <strong>Recovery</strong> tab, and set the failure value to <strong>Restart the Service</strong>.</li><li>On the <strong>General</strong> tab, select <strong>Automatic</strong> as the startup type, and then start the service. <br /> <br /> <img src="/knowledge_center/sites/default/files/field/image/CheckSQLServerAgent3.png" alt="" width="439" height="188" border="2" /></li></ol><h2><a name="createmaintenanceplan"></a><a name="checksqlserveragentservice"></a>Create the maintenance plan</h2><ol><li>Launch the SQL Management Studio and log in.</li><li>In the Object Explorer pane, go to <strong>Management</strong> &gt; <strong>Maintenance Plans</strong>, right-click <strong>Maintenance Plans</strong>, and select <strong>Maintenance Plan Wizard</strong>. <br /> <br /> <img src="/knowledge_center/sites/default/files/field/image/CreatingtheMaintenancePlan1_0.png" alt="" width="408" height="587" border="2" /><br /><br /></li><li>On the welcome page of the wizard, click&nbsp; <strong>Next</strong>.</li><li>On the&nbsp;Select Plan Properties&nbsp;page, specify a name for the plan, select&nbsp; <strong>Separate schedules for each task</strong>, and then click <strong>Next</strong>.</li><li>On the Select Maintenance Tasks page, select the <strong>Back Up Database (Full)</strong>,&nbsp; <strong>Back Up Database (Differential)</strong>, and <strong>Back Up Database (Transaction Log)</strong> check boxes, and then click <strong>Next</strong>.<br /><br /><img src="/knowledge_center/sites/default/files/field/image/Creatingthemaintenanceplan4.png" alt="" width="576" height="512" border="2"/><br /><br /></li><li>On the Select Maintenance Task Order page, leave the order as shown, and then click <strong>Next</strong>.</li></ol><h2><a name="fullbackupsettings"></a></h2><h2>Define full backup settings</h2><p>On the Define Back Up Database (Full) Task page, set up the full backup&nbsp; according to the following instructions.</p><ol><li>Select the databases that you want to back up (typically <strong>All user databases</strong>).</li><li>Specify when you want the backups to expire. In the following example, 14 days is specified. <br /><strong>Note</strong>: This setting overwrites the oldest backup file for rotation.</li><li>Select your backup media (typically <strong>Disk</strong>).</li><li>Specify a location (either Default or as assigned by you) for your backup files.</li><li>Select the <strong>Verify backup integrity</strong> check box.</li><li>To configure the scheduling options for this task, click <strong>Change</strong> near the bottom of the page.<br /><br /><img src="/knowledge_center/sites/default/files/field/image/fullbackupsetttings1.png" alt="" width="589" height="941" border="2"/><br /><br /></li><li>In the Job Schedule Properties dialog box, select <strong>Recurring</strong> for the Schedule type.</li><li>Specify the frequency of the backup. The following example shows full backups running on Monday, Wednesday, and Friday. Alter this to fit your backup plan.</li><li>Adjust the daily frequency according to when your backup needs to run.</li><li>Under <strong>Duration</strong>, adjust the <strong>Start</strong> and <strong>End</strong> dates. In the example <strong>No end date</strong> is selected.<br /><br /> <img src="/knowledge_center/sites/default/files/field/image/fullbackupsetttings2.png" alt="" width="680" height="591" border="2"/><br /><br /></li><li>Click <strong>OK</strong>.</li><li>On the Define Back Up Database (Full) Task page of the Maintenance Plan Wizard, click <strong>Next</strong>.</li></ol><h2><a name="differentialbackupsettings"></a>Define differential Backup Settings</h2><p>On the Define Back Up Database (Differential) Task page, set up the differential backup according to the following instructions. The settings are similar to the settings for the full backup.</p><ol><li>Select the databases that you want to back up (typically <strong>All user databases</strong>).</li><li>Specify when you want the backups to expire.</li><li>Select your backup media (typically <strong>Disk</strong>).</li><li>Specify a location (either Default or as assigned by you) for your backup files.</li><li>Select the <strong>Verify backup integrity</strong> check box.</li><li>To configure the scheduling options for this task, click <strong>Change</strong> near the bottom of the page.</li><li>In the Job Schedule Properties dialog box, select <strong>Recurring</strong> for the schedule type.</li><li>Specify the frequency of the backup. For example, you could choose to run differential backups on Tuesday, Thursday, Saturday, and Sunday.</li><li>Under <strong>Duration</strong>, adjust the daily frequency according to when your backup needs to run.</li><li>Adjust the <strong>Start</strong> and <strong>End</strong> dates.</li><li>Click <strong>OK</strong>.</li><li>On the Define Back Up Database (Differential) Task page of the Maintenance Plan Wizard, click <strong>Next</strong>.</li></ol><h2><a name="transactionlogbackupsettings"></a>Define transaction log backup settings</h2><p>On the Define Back Up Database (Transaction Log) Task page, set up the transaction log backup according to the following instructions.</p><ol><li>Select the databases that you want to back up (typically <strong>All user databases</strong>).</li><li>Do <em>not</em> select the <strong>Backup set will expire</strong> check box. <br />Expiration of transaction log backups is configured in the next section, â€œSet up the transaction log cleanup task."</li><li>Select your backup media (typically <strong>Disk</strong>).</li><li>Specify a location (either Default or as assigned by you) for your backup files.</li><li>Copy the path for the backup file and paste it to Notepad. You will need to refer to this path in later steps.</li><li>Select the <strong>Verify backup integrity</strong> check box.</li><li>To configure the scheduling options for this task, click <strong>Change</strong> near the bottom of the page. <br /> <strong>Note</strong> : You need to determine transaction log backup intervals based on transaction log growth. It might be necessary to run the transaction log backups at&nbsp; shorter intervals to prevent transaction logs from growing.</li><li>In the Job Schedule Properties dialog box, select&nbsp; <strong>Recurring</strong> for the Schedule type.</li><li>Specify the frequency of the backup. In the following example, the transaction log backups are running daily.</li><li>Adjust the daily frequency. In the following example, this is set to run every hour.</li><li>Under <strong>Duration</strong>, adjust the <strong>Start date</strong> and <strong>End date </strong>fields. <br /> <br /> <img src="/knowledge_center/sites/default/files/field/image/TransactionLogBackupSettings2.png" alt="" width="594" height="518" border="2"/></li><li>Click <strong>OK</strong>.</li><li>On the Define Back Up Database (Transaction Log) Task page of the Maintenance Plan Wizard, click <strong>Next</strong>.</li><li>On the Select Report Options page, specify how you want to save the details of the maintenance plan, and then click <strong>Next</strong>.</li><li>On the Complete the Wizard page, click <strong>Finish</strong>.</li><li>On the Maintenance Plan Wizard Progress page, click<strong> Close</strong>.</li><li>When you are returned to the SQL Server Management Studio main window, press <strong>F5</strong> to refresh the maintenance plan with the new settings.<br />The new maintenance plan is listed under <strong>Maintenance Plans</strong> in the Object Explorer pane.</li></ol><p>&nbsp;</p><h2><a name="transactionlogcleanup"></a>Set up the transaction Log Cleanup Task</h2><p>This section demonstrates how to set up a maintenance cleanup task. This task is set to clean up the transaction logs after three days. This setting keeps the one-hour transaction logs for three days, until the maintenance cleanup task deletes the old data. The transaction log cleanup must include a series of three days, which ensures that if you need to revert back to the second differential backup, you can apply the transaction logs from that time period. The goal is to have enough transaction log backups between the full and differential backups.</p><ol><li>Click the maintenance plan name.</li><li>In the Design pane, select the <strong>Subplan_3</strong>.</li><li>In the Toolbox pane, select <strong>Maintenance Cleanup Task</strong> and drag it into the transaction log backup area under the Design pane.</li><li value="4">Right-click on the <strong>Maintenance Cleanup Task</strong> and choose <strong>Edit</strong>. <br /> <br /> <img src="/knowledge_center/sites/default/files/field/image/TransactionLogCleanupTask2.png" alt="" width="278" height="150" border="2" /><br /><br /></li><li>In the Maintenance Cleanup Task dialog box, select <strong>Backup files</strong>.</li><li>Select <strong>Search folder and delete files based on an extension</strong>.</li><li>In the <strong>Folder</strong> text box, enter the path that you pasted into Notepad in the previous task. Ensure that you include the same path that your transaction logs are backing up to.</li><li>Enter the file extension type, <strong>trn</strong>.&nbsp; Do not precede the extension with a period.</li><li>Select the <strong>Include the first-level sub-folders</strong> check box.</li><li>Select the <strong>Delete files based on the age of the file at task run time</strong> check box, and set the file age to <strong>3 Days</strong>.<br /><img src="/knowledge_center/sites/default/files/field/image/TransactionLogCleanupTask3.png" alt="" width="484" height="566" border="2"/><br /><br /></li><li>Click <strong>OK</strong> to return to the Management Studio main window.</li><li>Drag the green arrow from the differential backup task to the maintenance cleanup task.</li><li>Double-click the connected green line. <br /> <br /> <img src="/knowledge_center/sites/default/files/field/image/TransactionLogCleanupTask4.png" alt="" width="353" height="287" border="2" /><br /><br /></li><li>In the Precedence Constraint Editor, set Value to Completion. <br />This setting allows the task to become conditional, meaning that if the differential backup did not run, then the transaction cleanup task is not run, or if the backup did run, the cleanup task is run.<br /><br /><img src="/knowledge_center/sites/default/files/field/image/TransactionLogCleanupTask5.png" alt="" width="445" height="370" border="2"/><br /><br /></li><li>Click <strong>OK</strong> to return to the Management Studio main window.<br />The line should now appear blue. <br /> <br /> <img src="/knowledge_center/sites/default/files/field/image/TransactionLogCleanupTask6.png" alt="" width="366" height="309" border="2" /></li><li>Save your work by selecting Save All from the File menu.<br />You have finished setting up your maintenance backup plan. You can adjust your backup plan to your needs, but you should first test it.</li></ol><h2><a name="testsetup"></a>Test your setup</h2><p>After you are done setting up your maintenance plan, verify that it works. You can wait a few days to see if the job completes, or you can force the job to run by performing the following steps.</p><ol><li>In the Object Explorer pane of SQL Server Management Studio, browse to <strong>SQL Server Agent</strong> &gt; <strong>Jobs</strong>.</li><li>Right-click the maintenance plan and select <strong>Start Job at Step</strong>. <br />This command runs the first section of the maintenance plan.</li><li>If the job completes without error, run the next step of the maintenance plan and test-run the setup. Repeat this step for all subplans that you created in the maintenance plan.</li></ol><p>If all of your steps run without error, your maintenance plan works and you are finished.</p><h2><a name="errors"></a>Troubleshoot errors by viewing the job history</h2><p><br /> If any of the jobs fail when testing the maintenance plan, view the job history to see what failed.</p><ol><li>In the Object Explorer pane, right-click the failed subplan and select <strong>View History</strong>.<br /> The Log File Viewer window, which shows the job history, is displayed. <br /> <br /> <img src="/knowledge_center/sites/default/files/field/image/Errors2_0.png" alt="" width="604" height="320" border="2" /><br /><p>If the job failed&nbsp; a red X icon is displayed next to the time that you ran the job.</p></li><li>Click the row for the failed job.<br />Details about the error appear below the table. Scroll or expand the pane to see more information.<br /> <br /> <img src="/knowledge_center/sites/default/files/field/image/Errors3.png" alt="" width="991" height="425" border="2" /></li><li>Troubleshoot the error and repeat the test-job.</li></ol><p>When your maintenance plan is reliable, check it in a few days to see if it is running as expected. Verify that the <strong>.bak</strong> files are being removed after the expiration and that the transaction logs are being cleaned up after three days.</p>
