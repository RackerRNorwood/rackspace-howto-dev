---
node_id: 416
title: PostgreSQL - Creating and Dropping Roles
permalink: article/postgresql-creating-and-dropping-roles
type: article
created_date: '2011-03-16 21:57:40'
created_by: RackKCAdmin
last_modified_date: '2011-03-21 22:1504'
last_modified_by: jered.heeschen
products: Cloud Servers
categories: Uncategorized
body_format: tinymce
---

<p>
	For testing and production use of our database server, we&#39;ll want to create additional <a href="/knowledge_center/index.php/PostgreSQL_-_Access_Control" title="PostgreSQL - Access Control">roles</a>, as it&#39;s not recommended to work regularly in our databases as the default superuser role.</p>
<p>
	<a id="Login" name="Login"></a></p>
<h2>
	<span class="mw-headline">Login </span></h2>
<p>
	However, to create additional roles we do need to run some commands as the postgres superuser role. This will require a login as the Linux user named &quot;postgres&quot;, as was explained in the <a href="/knowledge_center/index.php/PostgreSQL_-_Local_Connections_as_postgres" title="PostgreSQL - Local Connections as postgres">previous article</a>.</p>
<p>
	First, we need to login to our slice as a normal Linux user, then:</p>
<pre>
 
# sudo su - postgres
</pre>
<p>
	<a id="Connect_with_psql" name="Connect_with_psql"></a></p>
<h2>
	<span class="mw-headline">Connect with psql </span></h2>
<p>
	Now connect to the database server using the <a class="external text" href="http://www.postgresql.org/docs/8.3/static/app-psql.html" rel="nofollow" title="http://www.postgresql.org/docs/8.3/static/app-psql.html">psql</a> client, as the postgres role:</p>
<pre>
 
postgres@demo:~$ psql -U postgres
...
Welcome to psql 8.3.6, the PostgreSQL interactive terminal.
 
Type:  \copyright for distribution terms
       \h for help with SQL commands
       \? for help with psql commands
       \g or terminate with semicolon to execute query
       \q to quit
 
postgres=#
</pre>
<p>
	<a id="Creating_a_Role" name="Creating_a_Role"></a></p>
<h2>
	<span class="mw-headline">Creating a Role </span></h2>
<p>
	Connected with the psql client, we&#39;ll create a role that has the LOGIN attribute and a non-empty MD5-encrypted password:</p>
<pre>
 
postgres=#CREATE ROLE demorole1 WITH LOGIN ENCRYPTED PASSWORD &#39;password1&#39;;
</pre>
<p>
	Note the required trailing semicolon (&nbsp;; ) at the end of the SQL statement. The single-quotes ( &#39; &#39; ) are not part of the password, but must enclose it.</p>
<p>
	Did it work? We can check using &#39;\du&#39; command:</p>
<pre>
 
postgres=# \du
                               List of roles
 Role name | Superuser | Create role | Create DB | Connections | Member of 
-----------+-----------+-------------+-----------+-------------+-----------
 demorole1 | no        | no          | no        | no limit    | {}
 postgres  | yes       | yes         | yes       | no limit    | {}
(2 rows)
</pre>
<p>
	<a id="Dropping_a_Role" name="Dropping_a_Role"></a></p>
<h2>
	<span class="mw-headline">Dropping a Role </span></h2>
<p>
	What if we want to drop (delete, remove) a role? Easy:</p>
<pre>
 
postgres=#DROP ROLE demorole1;
</pre>
<p>
	If we check with the &#39;\du&#39; command we&#39;ll see that &#39;demorole1&#39; is no longer listed.</p>
<p>
	<a id="Alternative:_createuser_and_dropuser" name="Alternative:_createuser_and_dropuser"></a></p>
<h2>
	<span class="mw-headline">Alternative: createuser and dropuser </span></h2>
<p>
	Alternatively, we can create and drop database roles using the <a class="external text" href="http://www.postgresql.org/docs/8.3/static/app-createuser.html" rel="nofollow" title="http://www.postgresql.org/docs/8.3/static/app-createuser.html">createuser</a> and <a class="external text" href="http://www.postgresql.org/docs/8.3/static/app-dropuser.html" rel="nofollow" title="http://www.postgresql.org/docs/8.3/static/app-dropuser.html">dropuser</a> shell commands, which are basically &quot;wrappers&quot; for the CREATE and DROP SQL statements. They are included in a standard postgres installation.</p>
<p>
	With our present setup, we can only run these commands (successfully) as the postgres Linux user. We&#39;re still connected with the psql client, so let&#39;s exit with Ctrl-D or the &#39;\q&#39; command:</p>
<pre>
 
postgres=# \q
...
postgres@demo:~$
</pre>
<p>
	Good, we have a shell prompt as the postgres Linux user.</p>
<p>
	<a id="createuser" name="createuser"></a></p>
<h2>
	<span class="mw-headline">createuser </span></h2>
<p>
	With <a class="external text" href="http://www.postgresql.org/docs/8.3/static/app-createuser.html" rel="nofollow" title="http://www.postgresql.org/docs/8.3/static/app-createuser.html">createuser</a> we&#39;ll create a non-superuser role that has the LOGIN <a href="/knowledge_center/index.php/PostgreSQL_-_Access_Control" title="PostgreSQL - Access Control">attribute</a>.</p>
<pre>
 
postgres@demo:~$ createuser -PE demorole2
</pre>
<p>
	With the &#39;-P&#39; flag we&#39;re prompted to set a password for the new role, and the &#39;-E&#39; flag indicates the password should be stored as an MD5-encrypted string.</p>
<pre>
 
Enter password for new role: 
Enter it again: 
...
postgres@demo:~$
</pre>
<p>
	Having supplied and confirmed the password, we&#39;re returned to a shell prompt. If we reconnect with psql and run the &#39;\du&#39; command, we&#39;ll get this:</p>
<pre>
 
postgres=# \du
                               List of roles
 Role name | Superuser | Create role | Create DB | Connections | Member of 
-----------+-----------+-------------+-----------+-------------+-----------
 demorole2 | no        | no          | no        | no limit    | {}
 postgres  | yes       | yes         | yes       | no limit    | {}
(2 rows)
</pre>
<p>
	<a id="dropuser" name="dropuser"></a></p>
<h2>
	<span class="mw-headline">dropuser </span></h2>
<p>
	We can drop (delete, remove) a role with the <a class="external text" href="http://www.postgresql.org/docs/8.3/static/app-dropuser.html" rel="nofollow" title="http://www.postgresql.org/docs/8.3/static/app-dropuser.html">dropuser</a> shell command:</p>
<pre>
 
postgres@demo:~$ dropuser -i demorole2
...
Role &quot;demorole2&quot; will be permanently removed.
Are you sure? (y/n) y
...
postgres@demo:~$
</pre>
<p>
	The &#39;-i&#39; flag provides a confirmation prompt, which is a good safety measure when running a potentially destructive command.</p>
<p>
	<a id="Creating_a_superuser" name="Creating_a_superuser"></a></p>
<h2>
	<span class="mw-headline">Creating a superuser </span></h2>
<p>
	On occasion, we&#39;ll want to create additional superuser roles, e.g. when we have a database programmer whom we trust to administer our postgres server.</p>
<p>
	We can do this with the &#39;createuser&#39; shell command and the &#39;-s&#39; flag:</p>
<pre>
 
postgres@demo:~$ createuser -sPE mysuperuser
</pre>
<p>
	Alternatively, we can do the same thing from within a psql session, when we&#39;re connected as the postgres role (or another existing superuser):</p>
<pre>
 
postgres=#CREATE ROLE mysuperuser2 WITH SUPERUSER CREATEDB CREATEROLE LOGIN ENCRYPTED PASSWORD &#39;mysuperpass2&#39;;
</pre>
<p>
	We&#39;ve set the LOGIN attribute and a non-empty password &mdash; important if this superuser role will be specified for local and remote connections to the database. We&#39;ve also set the CREATEDB and CREATEROLE attributes. With those attributes specified, our SQL statement will match the action of the &#39;createuser -sPE&#39; command.</p>
