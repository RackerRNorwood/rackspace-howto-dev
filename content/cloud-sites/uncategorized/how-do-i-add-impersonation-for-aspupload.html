---
node_id: 581
title: How do I add impersonation for ASPUpload
permalink: article/how-do-i-add-impersonation-for-aspupload
type: article
created_date: '2011-03-16 21:57:40'
created_by: RackKCAdmin
last_modified_date: '2012-02-13 20:5302'
last_modified_by: matt.wheeler
products: Cloud Sites
categories: Uncategorized
body_format: tinymce
---

<p>We provide an ASP component installed on all the web servers that allows uploading files using classic asp. This component is called Persits AspUpload. If you want to upload files without giving public write, you can impersonate with your ftp account. The following below is an example that will display 3 fields to browse and select files to upload using your ftp account. This is more secure as public now does not have write access to your specific folder where your files will be uploaded at.</p>
<p>Create a file called uploads.asp and save the following text below in it.</p>
<pre>&lt;HTML&gt;

&lt;BODY BGCOLOR="#FFFFFF"&gt;

&lt;FORM METHOD="POST" ENCTYPE="multipart/form-data" ACTION="UploadScript1.asp"&gt;
&lt;INPUT TYPE=FILE SIZE=60 NAME="FILE1"&gt;&lt;BR&gt;

&lt;INPUT TYPE=FILE SIZE=60 NAME="FILE2"&gt;&lt;BR&gt;
&lt;INPUT TYPE=FILE SIZE=60 NAME="FILE3"&gt;&lt;BR&gt;
&lt;INPUT TYPE=SUBMIT VALUE="Upload!"&gt; &lt;/FORM&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;

</pre>
<br>
<p>Create another file called UploadScript1.asp and save the following text below in it.</p>
<ul>
<li>Please note that <strong>domain</strong> is the data center your website is located at. It will either be <strong>DFW</strong>, or <strong>ORD</strong>.</li>
</ul>
<pre>&lt;HTML&gt;
&lt;BODY&gt;

&lt;%

Set Upload = Server.CreateObject("Persits.Upload.1")
Upload.LogonUser "domain", "ftpUserName", "ftpPassword"

Count = Upload.Save("\\location\where\I\want\my\files\uploaded\at")

%&gt;
&lt;% = Count&nbsp;%&gt; files uploaded.

&lt;/BODY&gt;
&lt;/HTML&gt;
</pre>
<p>Now, just browse to your url www.mydomain.com/uploads.asp and you are ready to upload files.</p>
<p>Here's a working example of the above scripts, hosted on Cloud Sites.</p>
<IFRAME name="iframe" src="http://www.kc-windows-demo-site.com.asp1-19.dfw1-2.websitetestlink.com/uploads.asp" width=400 height=115 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=auto></IFRAME>
<p>For more information, please visit <a class="external free" title="http://www.aspupload.com/" href="http://www.aspupload.com/" rel="nofollow">http://www.aspupload.com/</a> for more examples and the manual.</p>
