---
node_id: 4681
title: First Gen to Next Gen Cloud Servers migration pre-checks
permalink: article/first-gen-to-next-gen-migration-pre-check
type: article
created_date: '2015-05-15 15:43:36'
created_by: David Hendler
last_modified_date: '2015-12-11 22:3752'
last_modified_by: renee.rendon
products: Cloud Servers
categories: Migrations
body_format: tinymce
---

<p><a id="top" name="top"></a>Before you open the migration window for each of your cloud servers, you must perform a series of checks to rule out common issues that you might encounter with migrations. If your cloud server fails any of these checks, a ticket will be created in your account so that you can fix the issue before your self-migration window opens. This article will help you understand and fix the results of these checks.</p>

<p><strong>Note:</strong> The checks will prevent your server from migrating correctly. If your server has not migrated correctly by the end of your window, data loss will occur when your source server is decommissioned.</p>

<p><a id="top"> </a></p>

<table>
	<tbody>
		<tr>
			<td>
			<h3>Contents</h3>

			<ol>
				<li><a href="#sellinux">SELinux check</a></li>
				<li><a href="#diskused">Disk used check</a></li>
				<li><a href="#kernel">Kernel overhead check</a></li>
				<li><a href="#inode">Inode count check</a></li>
				<li><a href="#pv">PV drivers check</a></li>
				<li><a href="#nova">Nova agent check</a></li>
			</ol>
			</td>
		</tr>
	</tbody>
</table>

<p>&nbsp;</p>

<p><a id="selinux"> </a></p>

<h2>SELinux check<a id="sellinux" name="sellinux"></a></h2>

<p>The SELinux check indicates whether SELinux is currently enabled on your server. SELinux interferes with several OS-level changes that are made by the Next Gen migration process. If the check fails (that is, if SELinux is detected), you don’t need to take any action. However, note that SELinux will not be automatically re-enabled after the migration. You must enable it manually.</p>

<p><a href="#top"><sup>back to top</sup></a></p>

<p><a id="diskused"> </a></p>

<h2>Disk used check<a id="diskused" name="diskused"></a></h2>

<p>The disk used check compares the amount of space used by your server with the total disk size available to determine percentage usage. The check thresholds are as follows:</p>

<ul>
	<li>Warning &gt; 80% usage</li>
	<li>Critical &gt; 89% usage</li>
</ul>

<p>Failing this check does not necessarily indicate that your migration will fail. However, large amounts of data will cause your migration to take significantly longer to complete. We recommend that before you initiate your self-migration, you move any unnecessary data off the server. You can use Rackspace Cloud Backup to perform this task.</p>

<p>&nbsp;</p>

<p>You can verify the results of this check by running <strong><code>df -h</code></strong> on a Linux cloud server, or by checking the properties of your disk from the <strong>My Computer</strong> screen in Windows.</p>

<p><a href="#top"><sup>back to top</sup></a></p>

<p><a id="kernel"> </a></p>

<h2>Kernel overhead check<a id="kernel" name="kernel"></a></h2>

<p>In a subset of the First Gen Linux infrastructure, the kernel and initial RAM disk are handled by the hypervisor instead of within your cloud server. Because the Next Gen environment uses only self-managed kernels, the migration process must inject your shared kernel and initramfs into your file system. This check ensures that there is sufficient free space on your disk for the kernel to be injected.</p>

<p>The results for this check are pass/fail.</p>

<p>If this test fails, your migration will fail. To rectify this issue, ensure that you have at least 5 to 10 GB free on your root partition.</p>

<p><a href="#top"><sup>back to top</sup></a></p>

<p><a id="inode"> </a></p>

<h2>Inode count check<a id="inode" name="inode"></a></h2>

<p>This check counts the actual number of files on your root file system. The check thresholds are as follows:</p>

<ul>
	<li>Warning &gt; 2 million</li>
	<li>Critical &gt; 3 million</li>
</ul>

<p>Like the disk usage check, failing this check does not necessarily indicate that your cloud server migration will fail, but an extremely high inode count will substantially increase migration time on early Linux cloud servers.</p>

<p>&nbsp;</p>

<p>To verify this check, run <strong><code>df -i</code></strong> from your Linux cloud server. Because there are no Windows cloud servers in our earliest environment, this check is not necessary for Windows cloud servers.</p>

<p>To reduce this issue, back up any unnecessary data (Rackspace Cloud Backup is good for this purpose), and remove it from the server.</p>

<p><a href="#top"><sup>back to top</sup></a></p>

<p><a id="pv"> </a></p>

<h2>PV drivers check<a id="pv" name="pv"></a></h2>

<p>The majority of the First Gen infrastructure and the entire Next Gen infrastructure use XenServer to power the host machines for your cloud servers. XenServer allows for a technology called <em>paravirtualization</em>, which increases the performance of virtualized networks and blocks devices in your cloud servers. For these paravirtualized devices to function, your cloud server must have the correct kernel modules (Linux) or device drivers (Windows) installed.</p>

<p>This check determines whether these drivers are present. The check runs only against cloud servers that already have these drivers installed; the rest of the Rackspace infrastructure will automatically install these drivers during your migration.</p>

<p>The results for this check are pass/fail.</p>

<p>If this check fails, the drivers must be reinstalled before your migration window. For Linux distributions, run the following script to install or update these drivers:</p>

<pre>
wget http://437117ba0e2524fdae22-6a87f3acbfcde81a104bb18fbb8cb85f.r47.cf2.rackcdn.com/xen_tools_installer.sh; \
chmod u+x xen_tools_installer.sh; bash xen_tools_installer.sh; rm -rf xen_tools_installer.sh</pre>

<p>For Gentoo, Arch, and FreeBSD, or if this installer fails, you must install these drivers manually. For Windows, see <a href="http://www.rackspace.com/knowledge_center/article/installing-xenserver-tools-on-next-generation-windows-cloud-servers">Installing XenServer Tools</a>.</p>

<p><a href="#top"><sup>back to top</sup></a></p>

<p><a id="nova"> </a></p>

<h2>Nova agent check<a id="nova" name="nova"></a></h2>

<p>In the XenServer infrastructure, the OpenStack® guest agent is the same as that used in the Next Gen Cloud Servers infrastructure. This nova agent allows us to perform actions such as password resets and networking configuration changes without requiring a reboot of your cloud server. As with the PV drivers check, this check is run only against cloud servers that should already have the agent installed.</p>

<p>The results for this check are pass/fail.</p>

<p>If your Linux server fails this check, run the following script as root to reinstall the agent through SSH or your Java console:</p>

<pre>
curl https://756c096c4fdec88dc549-ad3ecb862ed1ff9a4f44bb8d95040816.ssl.cf5.rackcdn.com/rax_nova_agent_install.sh | bash</pre>

<p>If your Windows server fails this check, follow these instructions:</p>

<ol>
	<li>Download the following package to your computer:
	<pre>
<a href="http://c4f6d65e7c9c0356f5c6-f834e6ac12bf8372533a9a3497063644.r92.cf2.rackcdn.com/AgentService.zip">http://c4f6d65e7c9c0356f5c6-f834e6ac12bf8372533a9a3497063644.r92.cf2.rackcdn.com/AgentService.zip</a>

</pre>
	</li>
	<li>Unzip the archive.<br />
	&nbsp;</li>
	<li>In the folder that is created, run the <strong><code>installagentservice.bat</code></strong> script from an administrator command prompt.<br />
	&nbsp;</li>
</ol>

<p>&nbsp;</p>

<table>
</table>
