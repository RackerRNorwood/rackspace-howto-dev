---
node_id: 1374
title: Monitoring Network Traffic
permalink: article/monitoring-network-traffic
type: article
created_date: '2012-04-04 20:18:26'
created_by: RackKCAdmin
last_modified_date: '2014-10-07 18:3404'
last_modified_by: jered.heeschen
products: Cloud Hosting
categories: Uncategorized
body_format: tinymce
---

<h3 style="text-align: left;">Basic Essential Network Monitoring</h3>

<ul>
	<li><a href="#preface">Preface</a></li>
	<li><a href="#monitoring">Monitoring in Linux</a></li>
	<li><a href="#aboutthetools">About The Tools</a></li>
	<li><a href="#debin">Ubuntu / Debian Installation</a></li>
	<li><a href="#centin">CentOS / RHEL Installation</a></li>
	<li><a href="#fedin">Fedora (16+) Installation</a></li>
	<li><a href="#susein">openSUSE Installation</a></li>
	<li><a href="#usingtoolsv">How to use VNstat</a></li>
	<li><a href="#usingtoolsi">How to use IPtraf</a></li>
	<li><a href="http://www.rackspace.com/knowledge_center/article/capturing-packets-with-tcpdump">How to use Tcpdump</a></li>
	<li><a href="#conclusion">Conclusion...</a></li>
</ul>

<hr />
<p><a id="preface" name="preface"></a></p>

<h3>Preface</h3>

<p>Basic administration principles state that you, the administrator, should have a strong grasp on what your server is doing at all times. One major metric that is sometimes missed is overall network activity. The metrics gained by proper network monitoring can reveal your traffic trends which will lead to a better understanding in the trends for your application, the load times on your system, and any activity that may not have been accounted for. Monitoring is essential to a successful infrastructure, and without it you will be forced to guess and or interpret logs which will lead to a misunderstanding of real traffic going to and leaving your server.</p>

<p><strong>Note:</strong> As an alternative to the setup described in this article, Rackspace offers its <a href="http://www.rackspace.com/cloud/monitoring/">Cloud Monitoring</a> service at no cost for use with Cloud Servers.&nbsp;For more information about this flexible service, see <a href="/knowledge_center/getting-started/cloud-monitoring">Getting Started with Cloud Monitoring</a>.</p>

<p><a id="monitoring" name="monitoring"></a></p>

<h3>Monitoring in Linux</h3>

<p>In the world of Linux there are many open source solutions that can accomplish the lofty goals of monitoring and logging "<strong>Actual</strong>" traffic. Most of these free and Open Source tools can work with minimal setup and achieve very high accuracy. Out of all the tools available I am partial to VNstat and IPtraf. Both of these can be found in most repositories, have minimal dependencies, and work on ALL Linux systems.</p>

<p><a id="aboutthetools" name="aboutthetools"></a></p>

<h3>About The Tools</h3>

<blockquote>
<p><strong>VNstat</strong> : <em><a href="http://humdi.net/vnstat/" target="_blank">Learn More about VNstat</a></em></p>

<p>VNstat is a console-based network traffic monitor for Linux and BSD that keeps a log of network traffic for the selected interface(s). It uses the network interface statistics provided by the kernel as information source. This means that VNstat won't actually be sniffing any traffic and also ensures light use of system resources. With VNstat you are able to keep a log of all incoming and outgoing traffic which will be logged by Minute,Hour,Day,Month,Year.</p>
</blockquote>

<blockquote>
<p><strong>IPtraf</strong> : <em><a href="http://iptraf.seul.org/about.html" target="_blank">Learn More about IPtraf</a></em></p>

<p>IPTraf is a console-based network statistics utility for Linux. It gathers a variety of figures such as TCP connection packet and byte counts, interface statistics and activity indicators, TCP/UDP traffic breakdowns, and LAN station packet and byte counts.</p>
</blockquote>

<h3>How to install these tools</h3>

<hr />
<p><a id="debin" name="debin"></a></p>

<h4>Ubuntu / Debian</h4>

<p><em>Here is how to install VNstat as well as IPtraf on a Ubuntu / Debian Slice.</em></p>

<p>Both of these tools are readily available on a Debian / Ubuntu Server.</p>

<p>A quick search will yield these packages.</p>

<pre>
apt-get update

apt-cache search iptraf
## iptraf - Interactive Colorful IP LAN Monitor

apt-cache search vnstat
## vnstat - console-based network traffic monitor
</pre>

<p>To do the installation of the tools on your server simply execute this command.</p>

<pre>
apt-get install iptraf vnstat
</pre>

<p>Lastly we setup VNstat to begin monitoring the interfaces.</p>

<pre>
# Public Interface
vnstat -u -i eth0

# Private Interface
vnstat -u -i eth1
</pre>

<hr size="1" />
<p><a id="centin" name="centin"></a></p>

<h4>CentOS / RHEL</h4>

<p><em>Here is how to install VNstat as well as IPtraf on a CentOS / RHEL Slice.</em></p>

<p>In the base repositories for CentOS and RHEL, IPtraf is easily installed. However, VNstat is not not found in these repositories and will either need to be installed via a third-party repository, or compiled from source. In this instance I choose to install from source. I made this choice because VNstat is a small package and has no real dependencies. At the time of this writing, VNstat 1.12&nbsp;is the latest version available.</p>

<p>VNstat is a simple package to install and here are the commands</p>

<p><strong>First</strong> - Download the source and unpack the source</p>

<pre>
cd ~/
wget http://humdi.net/vnstat/vnstat-1.12.tar.gz
tar xzf vnstat-1.12.tar.gz
cd ~/vnstat-1.12
</pre>

<p><strong>Second</strong> - Now make sure that you have the two needed packages installed, which are gcc and make, and then install vnstat</p>

<pre>
yum install gcc make
make
make install
</pre>

<p><strong>Third</strong> - Now that the package is installed we need to make it start, and automatically restart on boot.</p>

<pre>
cp ~/vnstat-1.12/examples/init.d/redhat/vnstat /etc/init.d/vnstat
chmod +x /etc/init.d/vnstat
/etc/init.d/vnstat start
cd /etc/init.d/
chkconfig --add vnstat
chkconfig vnstat on
cd ~/
</pre>

<p><strong>Fourth</strong> - Lastly we setup VNstat to begin monitoring the interfaces.</p>

<pre>
# Public Interface
vnstat -u -i eth0

# Private Interface
vnstat -u -i eth1
</pre>

<p>Here is the package that we will need to install on your server for IPtraf</p>

<p>You can search for the package like this :</p>

<pre>
yum search iptraf
## iptraf.x86_64 : A console-based network monitoring utility.
</pre>

<p>To install here is the command :</p>

<pre>
yum install iptraf.x86_64
</pre>

<hr size="1" />
<p><a id="fedin" name="fedin"></a></p>

<h4>Fedora (16+)</h4>

<p><em>Here is how to install VNstat as well as IPtraf on a Fedora Slice.</em></p>

<p>Both of the packages are readily available from the Fedora repositories.</p>

<p>A quick search will yield these packages.</p>

<pre>
yum search iptraf
## iptraf.x86_64 : A console-based network monitoring utility

yum search vnstat
## vnstat.x86_64 : Console-based network traffic monitor
</pre>

<p>The installation of the tools on your server is done by simply executing this command.</p>

<pre>
yum install iptraf vnstat
</pre>

<p>We need to setup VNstat to begin monitoring the interfaces.</p>

<pre>
# Public Interface
vnstat -u -i eth0

# Private Interface
vnstat -u -i eth1
</pre>

<p>Lastly we create a symlink for legacy purposes</p>

<pre>
ln -s /usr/sbin/iptraf-ng /usr/sbin/iptraf
</pre>

<hr size="1" />
<p><a id="susein" name="susein"></a></p>

<h4>openSUSE</h4>

<p><em>Here is how to install VNstat as well as IPtraf on a openSUSE Slice.</em></p>

<p>Like CentOS and RHEL, IPtraf is easily installed in openSUSE. However, VNstat is not not found in the repositories. You will either need to be installed via a&nbsp;third-party&nbsp;repository, or compiled from source. In this instance I choose to install from source. I made this choice because VNstat is a small package and has no real dependencies.</p>

<p>VNstat is a simple package to install here are the commands</p>

<p><strong>First</strong> - Download the source and unpack the source</p>

<pre>
cd ~/
wget http://humdi.net/vnstat/vnstat-1.12.tar.gz
tar xzf vnstat-1.12.tar.gz
cd ~/vnstat-1.12
</pre>

<p><strong>Second</strong> - Now make sure that you have the 2 needed packages installed, which are 'gcc' and 'make', and then install vnstat.</p>

<pre>
zypper ref
zypper in gcc make
make
make install
</pre>

<p><strong>Third</strong> - Now that the package is installed we need to make it start and automatically restart on boot.</p>

<pre>
cp ~/vnstat-1.12/examples/init.d/redhat/vnstat /etc/init.d/vnstat
chmod +x /etc/init.d/vnstat
/etc/init.d/vnstat start
cd /etc/init.d/
chkconfig --add vnstat
chkconfig vnstat on
cd ~/
</pre>

<p><strong>Fourth</strong> - Lastly we setup VNstat to begin monitoring the interfaces.</p>

<pre>
# Public Interface
vnstat -u -i eth0

# Private Interface
vnstat -u -i eth1
</pre>

<p>Here is the package that we will need to install on your server for IPtraf</p>

<p>A quick Search for the package reveals :</p>

<pre>
zypper se iptraf
## iptraf    | TCP/IP Network Monitor | srcpackage
</pre>

<p>To install iptraf here is the command :</p>

<pre>
zypper in iptraf</pre>

<h3>How to use these tools</h3>

<hr />
<p><a id="usingtoolsv" name="usingtoolsv"></a></p>

<h4>Using VNstat : <a href="http://linux.die.net/man/1/vnstat" target="_blank"><em>Manual Page for VNstat</em></a></h4>

<p>Once you have Installed and setup VNstat on your system you will have to allow for at least ONE hour. After that time frame, your database will contain data and begin showing you metrics.</p>

<p><strong>Common VNstat Uses</strong></p>

<ul>
	<li>
	<ul>
		<li>Snapshot : <strong>vnstat</strong></li>
	</ul>
	</li>
</ul>

<pre>
                      rx      /      tx      /     total    /   estimated
 eth0:
       Apr '12     26.68 MiB  /  196.70 MiB  /  223.38 MiB  /    1.38 GiB
     yesterday      6.35 MiB  /   37.71 MiB  /   44.06 MiB
         today      4.73 MiB  /   34.66 MiB  /   39.39 MiB  /      52 MiB
</pre>

<ul>
	<li>
	<ul>
		<li>Hourly Report : <strong>vnstat -h</strong></li>
	</ul>
	</li>
</ul>

<pre>
 eth0                                                                     17:02 
  |            t  t                    t  t  t  t              t  t  t          
  |      t     t  t                    t  t  t  t     t     t  t  t  t          
  |      t  t rt rt    rt  t  t        t  t  t  t  t  t  t  t  t  t  t  t       
 -+---------------------------------------------------------------------------&gt; 
  |  18 19 20 21 22 23 00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17    
 h  rx (KiB)   tx (KiB)      h  rx (KiB)   tx (KiB)      h  rx (KiB)   tx (KiB) 
18        157        607    02        143        888    10        150       1878
19        266       1389    03        169        548    11        212       1229
20        259        918    04         72        449    12        191       1904
</pre>

<ul>
	<li>
	<ul>
		<li>Daily Report : <strong>vnstat -d</strong></li>
	</ul>
	</li>
</ul>

<pre>
 eth0  /  daily
 eth0  /  daily
         day         rx      |     tx      |    total    |   avg. rate
     ------------------------+-------------+-------------+---------------
      04/01/12      4.91 MiB |   43.77 MiB |   48.67 MiB |    4.61 kbit/s
      04/02/12      6.65 MiB |   46.65 MiB |   53.30 MiB |    5.05 kbit/s
      04/03/12      4.04 MiB |   33.92 MiB |   37.96 MiB |    3.60 kbit/s
      04/04/12      6.35 MiB |   37.71 MiB |   44.06 MiB |    4.18 kbit/s
      04/05/12      4.73 MiB |   34.66 MiB |   39.39 MiB |    5.26 kbit/s
     ------------------------+-------------+-------------+---------------
     estimated         5 MiB |      47 MiB |      52 MiB |
</pre>

<ul>
	<li>
	<ul>
		<li>Weekly Report : <strong>vnstat -w</strong></li>
	</ul>
	</li>
</ul>

<pre>
 eth0  /  weekly
                      rx      |     tx      |    total    |   avg. rate
   ---------------------------+-------------+-------------+---------------
    last 7 days     36.62 MiB |  256.09 MiB |  292.71 MiB |    4.13 kbit/s
      last week     42.62 MiB |  237.17 MiB |  279.78 MiB |    3.79 kbit/s
   current week     21.79 MiB |  152.97 MiB |  174.75 MiB |    4.46 kbit/s
   ---------------------------+-------------+-------------+---------------
      estimated        39 MiB |     286 MiB |     325 MiB |
</pre>

<ul>
	<li>
	<ul>
		<li>Monthly Report : <strong>vnstat -m</strong></li>
	</ul>
	</li>
</ul>

<pre>
 eth0  /  monthly
      month        rx      |     tx      |    total    |   avg. rate
    ------------------------+-------------+-------------+---------------
      Apr '12     26.68 MiB |  196.70 MiB |  223.38 MiB |    4.50 kbit/s
    ------------------------+-------------+-------------+---------------
    estimated       165 MiB |    1.22 GiB |    1.38 GiB |
</pre>

<p>&nbsp;</p>

<hr size="1" />
<p><a id="usingtoolsi" name="usingtoolsi"></a></p>

<h4>Using IPtraf :</h4>

<p>&nbsp;</p>

<h4><a href="http://linux.die.net/man/8/iptraf" target="_blank"><em>Manual Page for IPtraf</em></a></h4>

<p>IPtraf is an application that can be used just as soon as it is installed. IPtraf watches traffic in real time.</p>

<p><strong>IPtraf Commands </strong></p>

<ul>
	<li>General Output : <strong>iptraf -g</strong>

	<p style="text-align: center;"><img alt="" src="http://c13291525.r25.cf2.rackcdn.com/IMAGE1.png" style="width: 700px; height: 436px;" /></p>
	</li>
	<li>Detailed Information on a Select Interface : <strong>iptraf -d iface</strong>
	<p style="text-align: center;"><img alt="" src="http://c13291525.r25.cf2.rackcdn.com/IMAGE2.png" style="width: 700px; height: 437px;" /></p>
	</li>
	<li>Semi-Graphical Interface : <strong>iptraf</strong>
	<p style="text-align: center;"><img alt="" src="http://c691244.r44.cf2.rackcdn.com/IPtrafe-IMAGE3.jpg" style="width: 700px; height: 439px;" /></p>

	<p style="text-align: center;">&nbsp;</p>
	</li>
</ul>

<p><a id="conclusion" name="conclusion"></a></p>

<h3>Conclusion</h3>

<hr />
<p>Now that you have installed these packages you should have full network monitoring in place. VNstat will monitor the servers internal and external network interfaces for all sent and received traffic. While IPtraf will allow you the ability to use a utility from the shell to gauge network traffic in real time. These tools are invaluable and should provide a lot more insight into your overall operations.</p>
