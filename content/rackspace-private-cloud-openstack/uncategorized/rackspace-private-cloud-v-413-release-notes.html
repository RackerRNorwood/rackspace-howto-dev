---
node_id: 3798
title: Rackspace Private Cloud v. 4.1.3 Release Notes
permalink: article/rackspace-private-cloud-v-413-release-notes
type: article
created_date: '2013-12-03 20:33:21'
created_by: Karin Levenstein
last_modified_date: '2014-01-16 18:1147'
last_modified_by: jered.heeschen
products: Rackspace Private Cloud - OpenStack
categories: Uncategorized
body_format: tinymce
---

<p>Rackspace Private Cloud v 4.1.3 has the following changes and documentation. For the full list of known issues and information from the Rackspace Private Cloud v 4.0 and v. 4.1.2 releases, refer to:</p><ul><li><a href="http://www.rackspace.com/knowledge_center/article/rackspace-private-cloud-v-40-release-notes">Rackspace Private Cloud v. 4.0 Release Notes</a></li><li><a href="http://www.rackspace.com/knowledge_center/article/rackspace-private-cloud-v-412-release-notes-0">Rackspace Private Cloud v. 4.1.2 Release Notes</a></li></ul><p class="link" title="Cookbook Changes">Rackspace Private Cloud v 4.1.3 has the following changes.</p><ul><li><a class="link" title="Cookbook Changes" href="#cookbook-download-4.1.3">Cookbook Changes</a></li><li><a class="link" title="Upgrading to v4.1.3 from v4.1.2 in HA Environments" href="#upgrade-4.1.3">Upgrading to v4.1.3 from v4.1.2</a></li><li><a class="link" title="Upgrading to v4.1.3 on CentOS" href="#upgrade-4.1.3-centos">Upgrading to v4.1.3 on CentOS</a></li><li><a class="link" title="Rackspace Private Cloud Changes" href="#general-4.1.3">General Changes</a></li><li><a class="link" title="High Availability" href="#high-availability-4.1.3">High Availability</a></li><li><a class="link" title="OpenStack Compute" href="#openstack-compute-4.1.3">OpenStack Compute</a></li><li><a class="link" title="OpenStack Dashboard" href="#openstack-dashboard-4.1.3">OpenStack Dashboard</a></li><li><a class="link" title="OpenStack Image Storage" href="#openstack-image-4.1.3">OpenStack Image Storage</a></li><li><a class="link" title="OpenStack Metering" href="#openstack-metering-4.1.3">OpenStack Metering</a></li><li><a class="link" title="OpenStack Networking" href="#openstack-networking-4.1.3">OpenStack Networking</a></li><li><a class="link" title="Resolved Issues" href="#resolved-4.1.3">Resolved Issues</a></li></ul><div class="section" title="Cookbook Changes"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a name="cookbook-download-4.1.3"></a>Cookbook Changes</h2></div></div></div><p>The latest cookbook version number is <code class="filename">v4.1.3</code>. This change is reflected in the instructions under <a class="link" href="http://www.rackspace.com/knowledge_center/article/installing-openstack-with-rackspace-private-cloud-tools#install-cookbooks" target="_top">Install the Rackspace Private Cloud Cookbooks</a>.</p></div><div class="section" title="Upgrading to v4.1.3 from v4.1.2 in HA Environments"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a name="upgrade-4.1.3"></a>Upgrading to v4.1.3 from v4.1.2 in HA Environments</h2></div></div></div><p>When upgrading to v4.1.3 from v4.1.2 in HA environments, you will need to follow this procedure to ensure that the services update correctly.</p><ol><li>Edit the environment by changing the <code class="filename">do_package_upgrades</code> and <code class="filename">image_upload</code> override attributes. This forces the package upgrades and also disables image uploading, which enables you to work around issues related to Glance.<pre class="screen">    "override_attributes": {
      "osops": {
        "do_package_upgrades": true
      },
      [...]
      "glance": {
        "image_upload": false
      },
      [...]
      }
                        </pre></li><li>On the <code class="filename">ha-controller2</code> node, stop all services except for mysql. You will need to wait about 30 seconds for the services to stop. The following commands can be used to restart the services.<pre class="screen">for i in `monit status | grep Process | awk '{print $2}' | grep -v mysql | sed "s/'//g"`;
  do monit stop $i;
done
                            </pre></li><li>Stop Keepalived on <code class="filename">ha-controller2</code> and wait approximately ten seconds for the VIPs to migrate to <code class="filename">ha-controller1</code>.</li><li>Run chef-client on <code class="filename">ha-controller1</code> to perform the upgrade.<p>On Ubuntu, you will run chef-client twice:</p><pre class="screen"># chef-client

<code class="computeroutput">INFO: Processing mysql_database[create keystone database] action create (keystone::setup line 34)
================================================================================
Error executing action `create` on resource 'mysql_database[create keystone database]'
================================================================================
<em class="replaceable"><code>[sample output truncated]</code></em></code>

# chef-client
                            </pre><p>On CentOS, you will have to run chef-client twice, restart Keepalived, and run chef-client again. This is related to a known issue</p><pre class="screen"># chef-client

<code class="computeroutput">INFO: Processing mysql_database[create keystone database] action create (keystone::setup line 34)
================================================================================
Error executing action `create` on resource 'mysql_database[create keystone database]'
================================================================================
<em class="replaceable"><code>[sample output truncated]</code></em></code>

# chef-client

<code class="computeroutput">INFO: Processing keystone_register[Recreate keystone Endpoint] action recreate_endpoint (openstack-ha::default line 184)
<em class="replaceable"><code>[sample output truncated]</code></em></code>

# service keepalived restart
# chef-client
                            </pre></li><li>Run chef-client on <code class="filename">ha-controller2</code>, then on <code class="filename">ha-controller1</code>, and finally on the compute nodes.</li><li>Restart the services on <code class="filename">ha-controller2</code>. The following commands can be used to restart the services.<pre class="screen">for i in `monit status | grep Process | awk '{print $2}' | grep -v mysql | sed "s/'//g"`;
  do monit start $i;
done
                            </pre></li><li>Reboot the devices to ensure that the OpenvSwitch module is active.</li></ol></div><div class="section" title="Upgrading to v4.1.3 on CentOS"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a name="upgrade-4.1.3-centos"></a>Upgrading to v4.1.3 on CentOS</h2></div></div></div><p>Before upgrading to v4.1.3 from v4.0.0 or v4.1.2 on CentOS, you must upgrade the kernel on any Controller nodes in your cluster. Log into the Controller node and execute the following command:</p><pre class="programlisting"># rpm -Uvh http://repos.fedorapeople.org/repos/openstack/openstack-grizzly/epel-6/kernel-2.6.32-358.123.2.openstack.el6.x86_64.rpm \
  http://repos.fedorapeople.org/repos/openstack/openstack-grizzly/epel-6/kernel-firmware-2.6.32-358.123.2.openstack.el6.noarch.rpm \
  http://repos.fedorapeople.org/repos/openstack/openstack-grizzly/epel-6/kernel-headers-2.6.32-358.123.2.openstack.el6.x86_64.rpm     
                </pre><p>After the kernel upgrade is complete, reboot the Controller nodes and upload the v4.1.3 cookbooks. You can then run chef-client on the Controller nodes to complete the upgrade. You do not need to make any changes to the environment attributes.</p><p>The following changes have been made to Rackspace Private Cloud on CentOS and RHEL:</p><ul><li>The chef-client native selinux handling is used, instead of restoring selinux contexts explicitly in cookbooks.</li><li>A patch has been added for amqplib to enable the SO_KEEPALIVE option on sockets, which allows faster failover detection for RabbitMQ.</li></ul></div><div class="section" title="Rackspace Private Cloud Changes"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a name="general-4.1.3"></a>Rackspace Private Cloud Changes</h2></div></div></div><p>The following changes have been made to Rackspace Private Cloud:</p><ul><li>Infrequently used informational messages in Chef runs have been converted to debug messages. This reduces the number of extraneous messages during a chef-client run.</li><li>The repository can be searched based on tag in addition to role and recipe.</li><li>Endpoint schema now allow for DNS-based endpoints.</li><li>Rackspace Private Cloud now uses RabbitMQ 3.x.</li><li>A new package repository houses the RPCDaemon packages, which improves certain HA features.</li></ul></div><div class="section" title="High Availability"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a name="high-availability-4.1.3"></a>High Availability</h2></div></div></div><p>The following changes have been made to High Availability in Rackspace Private Cloud:</p><ul><li>Changes to Keepalived that enable increased reliability under a wider range of circumstances, such as manual failover for maintenance, power loss, and network isolation.</li><li>Issues with lost messages during RabbitMQ failover have been resolved.</li><li>A newer RabbitMQ version provides more robust replication behavior for improved active-active HA functionality.</li><li>OpenStack Networking availability in failure scenarios has been increased. The RPCDaemon tool improves OpenStack Networking scheduling of DHCP agents and L3 agents.</li></ul></div><div class="section" title="OpenStack Compute"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a name="openstack-compute-4.1.3"></a>OpenStack Compute</h2></div></div></div><p>The following changes have been made to the support of OpenStack Compute (Nova) in Rackspace Private Cloud:</p><ul><li>Optional SSL support has been added for nova-novncproxy.</li><li>Template statements for the config files have been added.</li><li>The following attributes have been added:<div class="itemizedlist"><ul class="itemizedlist" type="circle"><li>max_age</li><li>reserved_host_disk_mb</li><li>libvirt_inject_password</li><li>libvirt_inject_partition</li></ul></div></li></ul></div><div class="section" title="OpenStack Dashboard"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a name="openstack-dashboard-4.1.3"></a>OpenStack Dashboard</h2></div></div></div><p>The following changes have been made to the support of OpenStack Dashboard (Horizon) in Rackspace Private Cloud:</p><ul><li>New override attributes give the user greater flexibility in customizing the Dashboard, including help_url customization. The following example shows an environment override for a custom theme:<pre class="programlisting">    "horizon": {
      "theme": "default",
      "theme_css_update_style": "download_list",
      "theme_css_list": [ "custom_overlay.css" ],
      "theme_css_base": "http://web.example.org/theme_files",
      "theme_image_update_style": "download_list",
      "theme_image_list": [ "custom_logo.png", "custom_favicon.ico" ],
      "theme_image_base": "http://web.example.org/theme_files",
      "config": {
        "template_debug": true
      }
    }
                            </pre></li><li>Users can now override the Keystone endpoint that the Dashboard uses.</li><li><code class="filename">CSRF_COOKIE_SECURE</code> and <code class="filename">SESSION_COOKIE_SECURE</code> are enabled when using SSL.</li><li>Users can turn off password auto-complete in web browsers.</li></ul></div><div class="section" title="OpenStack Identity"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a name="openstack-id-4.1.3"></a>OpenStack Identity</h2></div></div></div><p>You can now enable SSL on internal, service, and admin endpoints individually in a Rackspace Private Cloud environment.</p></div><div class="section" title="OpenStack Image Storage"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a name="openstack-image-4.1.3"></a>OpenStack Image Storage</h2></div></div></div>Unused Object Storage configurations have been removed from the Image Storage configuration for when Object Storage is not in use.</div><div class="section" title="OpenStack Metering"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a name="openstack-metering-4.1.3"></a>OpenStack Metering</h2></div></div></div><p>The following changes have been made to the support of OpenStack Metering (Ceilometer) in Rackspace Private Cloud:</p><ul><li>Logging defaults to verbose.</li><li>The verbose and debug configuration options can be overridden separately.</li><li>HA queue awareness improves failover consistency.</li></ul></div><div class="section" title="OpenStack Networking"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a name="openstack-networking-4.1.3"></a>OpenStack Networking</h2></div></div></div><p>L3 agent support is now available, which enables floating IPs and routers. For more information about L3 routing, refer to <a class="link" href="http://docs.openstack.org/network-admin/admin/content/l3_workflow.html" target="_top">"L3 Routing and NAT" in the OpenStack Networking Administration Guide</a>.</p></div><div class="section" title="Resolved Issues"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a name="resolved-4.1.3"></a>Known and Resolved Issues</h2></div></div></div><p>A known issue has been identified regarding upgrades from v4.1.2 to v4.1.3. Due to race conditions in restarting keepalived, chef-client failures are expected in the upgrade from v4.1.2 to v4.1.3. On Ubuntu, you will need to run chef-client twice, and on CentOS you will need to run chef-client twice and restart keepalived. The procedure for this has been documented in <a class="link" title="Upgrading to v4.1.3 from v4.1.2 in HA Environments" href="#upgrade-4.1.3">Upgrading to v4.1.3 from v4.1.2</a>.</p><p>The following issues have been resolved in v4.1.3 of Rackspace Private Cloud:</p><ul><li>In some circumstances, the nova-novncproxy web service could provide a directory listing. This low-risk security concern has been removed.</li><li>Logging issues in SSL mod_wsgi services have been fixed.</li><li>A memcache server sort order issue has been fixed. This issue could cause a spurious regeneration of the nova config template, which would trigger a service restart.</li><li>Numerous process matching issues with monit configurations on most services have been fixed. These issues could cause monit to fail to restart processes correctly.</li></ul></div>
