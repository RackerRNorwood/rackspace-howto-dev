---
node_id: 3454
title: Accessing Rackspace Services Via Isolated Networks through the Vyatta Network Appliance
permalink: article/accessing-rackspace-services-via-isolated-networks-through-the-vyatta-network-appliance
type: article
created_date: '2013-05-02 19:20:01'
created_by: sameer.satyam
last_modified_date: '2014-03-06 12:2325'
last_modified_by: David Hendler
products: Cloud Servers
categories: Server Management
body_format: tinymce
---

<h2>Introduction</h2><p>In order to access Rackspace services from your cloud servers, you traditionally need the servers to be connected to ServiceNet and/or Public interfaces. It is possible to detach your servers from either of these networks and have servers be connected only to isolated network interfaces if you want to restrict access to them. However, this would cause you to lose access to some Rackspace services.</p><p>The article below describes what services are impacted by disconnecting Public and/or SNET interfaces from your cloud servers.</p><p><a href="http://www.rackspace.com/knowledge_center/article/removing-networks-from-a-cloud-server" target="_blank">http://www.rackspace.com/knowledge_center/article/removing-networks-from-a-cloud-server</a></p><h2>Vyatta Network Appliance</h2><p>The Vyatta network appliance provides you with an easy-to-configure firewall, advanced networking and VPN capabilities in addition to increased security in the Cloud. Using this appliance , you can detach your servers from Public and SNET interfaces and still retain access to Rackspace services. In this article you will see how this can be accomplished.</p><h2>Accessing Rackspace services using NAT on the Vyatta appliance</h2><p>In the below setup the cloud server is connected only on the isolated network (cloud network). The Vyatta is also on the same cloud network and is used as the default gateway by the server in question. The Vyatta appliance is connected to all three networks (Public, SNET and Isolated).<span style="line-height: 1.538em;">&nbsp;</span></p><p><img class="image-half_width" src="/knowledge_center/sites/default/files/styles/half_width/public/field/image/Vyatta.jpg" alt="" width="350" height="224" border="2" /></p><p><span style="line-height: 1.538em;">The table below summarizes what services can be accessed if the Vyatta is configured as described in the next section:</span></p><table style="width: 306pt;" width="306" border="0" cellspacing="0" cellpadding="0"><!--StartFragment--> <colgroup><col style="mso-width-source: userset; mso-width-alt: 6826; width: 160pt;" width="160" /> <col style="mso-width-source: userset; mso-width-alt: 6229; width: 146pt;" width="146" /> </colgroup><tbody><tr style="height: 16.0pt;"><td class="xl64" style="height: 16.0pt; width: 160pt;" width="160" height="16"><strong>Service</strong></td><td class="xl64" style="width: 146pt;" width="146"><strong>Works ?</strong></td></tr><tr style="height: 13.0pt;"><td class="xl63" style="height: 13.0pt;" height="13">Cloud Backup</td><td class="xl63">Yes</td></tr><tr style="height: 13.0pt;"><td class="xl63" style="height: 13.0pt;" height="13">Cloud Databases</td><td class="xl63">Yes</td></tr><tr style="height: 13.0pt;"><td class="xl63" style="height: 13.0pt;" height="13">Cloud Files</td><td class="xl63">Yes</td></tr><tr style="height: 13.0pt;"><td class="xl63" style="height: 13.0pt;" height="13">Cloud Monitoring</td><td class="xl63">No</td></tr><tr style="height: 13.0pt;"><td class="xl63" style="height: 13.0pt;" height="13">Managed Cloud Service Level</td><td class="xl63">No (Vyatta Network appliance is not supported for accounts with Managed Cloud Service Level)</td></tr><tr style="height: 13.0pt;"><td class="xl63" style="height: 13.0pt;" height="13">Operating System Updates</td><td class="xl63">Yes</td></tr><tr style="height: 13.0pt;"><td class="xl63" style="height: 13.0pt;" height="13">RackConnect</td><td class="xl63">No (Vyatta Network Appliance is not supported for RackConnect)</td></tr><tr style="height: 13.0pt;"><td class="xl63" style="height: 13.0pt;" height="13">Windows Activiation</td><td class="xl63">Yes</td></tr><!--EndFragment--></tbody></table><p>&nbsp;</p><h2>Configuration</h2><p>In order for the services listed in the table above to work as explained , the Vyatta appliance needs to be configured with Source NAT. &nbsp;For a more comprehensive explanation of Source NAT configuration , visit the link below:&nbsp;</p><p><a href="http://www.rackspace.com/knowledge_center/article/enable-internet-access-on-cloud-servers-using-snat-on-a-vyatta-network-appliance" target="_blank">http://www.rackspace.com/knowledge_center/article/enable-internet-access-on-cloud-servers-using-snat-on-a-vyatta-network-appliance</a></p><h6>Note: The cloud servers are on the isolated interface 192.168.1.0/24 and they are using the Vyatta network appliance as their default gateway</h6><p>Login to the Vyatta appliance and enter configuration mode<span style="line-height: 1.538em;">&nbsp;</span></p><pre>$ ssh vyatta@x.x.x.x<br /><span style="font-size: 1.231em; line-height: 1.538em;">Welcome to Vyatta<br /></span><span style="font-size: 1.231em; line-height: 1.538em;">vyatta@x.x.x.x's password:&nbsp;<br /></span><span style="font-size: 1.231em; line-height: 1.538em;">Welcome to Vyatta<br /></span><span style="font-size: 1.231em; line-height: 1.538em;">Version: &nbsp; &nbsp; &nbsp;VSE6.5R2<br /></span><span style="font-size: 1.231em; line-height: 1.538em;">Description: &nbsp;Vyatta Subscription Edition 6.5 R2<br /></span><span style="font-size: 1.231em; line-height: 1.538em;">Copyright: &nbsp; &nbsp;2006-2012 Vyatta, Inc.<br /></span><span style="font-size: 1.231em; line-height: 1.538em;">Last login: Thu May &nbsp;2 04:48:29 2013 from x.x.x.x<br /></span><span style="font-size: 1.231em; line-height: 1.538em;">vyatta@vyatta-thefinal:~$&nbsp;<br /></span><span style="font-size: 1.231em; line-height: 1.538em;">vyatta@vyatta-thefinal:~$ configure<br /></span><span style="font-size: 1.231em; line-height: 1.538em;">[edit]<br /></span><span style="font-size: 1.231em; line-height: 1.538em;">vyatta@vyatta-thefinal#&nbsp;</span></pre><p><span style="font-family: 'Lucida Grande', 'Lucida Sans Unicode', sans-serif; font-size: 13px; line-height: 1.538em;"><br />Configure Source NAT for ServiceNet traffic. eth1 is the SNET interface on the Vyatta. Any traffic going out via SNET will now use a source IP of the SNET interface on the Vyatta.</span></p><pre class="p1">set nat source rule 10 outbound-interface 'eth1'<br /><span style="font-size: 1.231em; line-height: 1.538em;">set nat source rule 10 protocol 'all'<br /></span><span style="font-size: 1.231em; line-height: 1.538em;">set nat source rule 10 source address '192.168.1.0/24'<br /></span><span style="font-size: 1.231em; line-height: 1.538em;">set nat source rule 10 translation address 'masquerade'</span></pre><p class="p1"><span style="font-family: 'Lucida Grande', 'Lucida Sans Unicode', sans-serif; font-size: 13px; line-height: 1.538em;"><br />Configure Source NAT for PublicNet traffic. eth0 is the Public interface on the Vyatta.&nbsp;</span><span style="line-height: 1.538em;">Any traffic going out via PublicNet will now use a source IP of the Public interface on the Vyatta.</span></p><pre class="p1">set nat source rule 20 outbound-interface 'eth0'<br /><span style="font-size: 1.231em; line-height: 1.538em;">set nat source rule 20 protocol 'all'<br /></span><span style="font-size: 1.231em; line-height: 1.538em;">set nat source rule 20 source address '192.168.1.0/24'<br /></span><span style="font-size: 1.231em; line-height: 1.538em;">set nat source rule 20 translation address 'masquerade'</span></pre><p><br />This simple configuration should allow you to access the services listed in the table. You may also want to configure firewall policies on the Vyatta appliance. For configuration assistance of firewall policies on Vyatta please visit the URL below:</p><p><a href="http://www.rackspace.com/knowledge_center/article/configuring-interface-based-firewall-on-the-vyatta-network-appliance" target="_blank">http://www.rackspace.com/knowledge_center/article/configuring-interface-based-firewall-on-the-vyatta-network-appliance<br /></a></p>
