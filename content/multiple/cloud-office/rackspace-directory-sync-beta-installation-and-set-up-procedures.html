---
node_id: 3435
title: 'Rackspace Directory Sync: Install and configure'
permalink: article/rackspace-directory-sync-beta-installation-and-set-up-procedures
type: article
created_date: '2013-04-25 17:00:25'
created_by: kevin.richey
last_modified_date: '2015-01-28 13:4925'
last_modified_by: aaron.medrano
products: 'Rackspace Email,Exchange'
categories: Cloud Office
body_format: tinymce
---

<h2>Systems Requirements</h2>

<p>Functional level of domain controller and Active Directory</p>

<ul>
	<li>Windows Server 2008</li>
	<li>Windows Server 2008 R2</li>
	<li>Windows Server 2012 R1 &amp; R2</li>
</ul>

<h3>Important notes:</h3>

<ul>
	<li>The Directory Sync service <em>must be installed</em> <em>directly</em> on your domain controller.</li>
	<li>After installation, Directory Sync <em>cannot</em> automatically synchronize existing passwords because they are unreadable from the Active Directory. Passwords <strong>must be reset</strong> after installation to ensure password synchronization.</li>
	<li>Directory Sync is compatible with Hosted Exchange 2010, Hosted Exchange 2013, and Rackspace Email only.</li>
</ul>

<h3>Software prerequisites</h3>

<p>You must have NET Framework version 4.0 on the target domain controller and any other domain controllers in the forest. &nbsp;You can download the appropriate .NET Framework from the <a href="http://www.microsoft.com/download/en/details.aspx?id=17718">Microsoft Download Center</a>.</p>

<h3>Firewall ports</h3>

<p>You do not have to open any inbound ports from the Internet to your domain controllers.</p>

<p>Enable the following ports on the Directory Sync server:</p>

<ul>
	<li><strong>443</strong> –Outbound HTTPS connections from the Directory Sync service to the Rackspace API.</li>
	<li><strong>8732</strong> – Open for connections from other domain controllers to the Directory Sync server not used for any connections outside your network. This port is used by domain controller password hooks.&nbsp;</li>
	<li><strong>8080</strong> – Used only locally on the Directory Sync service server for a web browser user interface. You can block this port for any external connections.</li>
</ul>

<h3>Network encryption</h3>

<p>Communication between Directory Sync and Rackspace is secured through HTTPS.&nbsp;Communications between the Active Directory password hook and Directory Sync is secured with Microsoft Windows Communication Foundation (WCF) transport security which uses Windows authentication and encryption.</p>

<h3>Installation files</h3>

<p>You can find the installation files can be found while logged into either <a href="cp.rackspace.com" target="_blank">cp.rackspace.com</a> or into the <a href="my.rackspace.com" target="_blank">my.rackspace.com</a>,&nbsp;depending on how you normally log in.</p>

<p>Administrators who log in to <a href="my.rackspace.com" target="_blank">my.rackspace.com</a>, as the primary contact can follow these steps:</p>

<ol>
	<li>Click the <strong>Products</strong> tab and select <strong>Email and Apps</strong> from the menu.</li>
	<li>Click on your domain.</li>
</ol>

<p>&nbsp; &nbsp; &nbsp; &nbsp;The Directory Sync installers are located in the right hand column.</p>

<p>Administrators who log in to <a href="cp.rackspace.com" target="_blank">cp.rackspace.com</a>&nbsp;with&nbsp;Super Admin permission can follow these steps:</p>

<ol>
	<li>While on the home page, click Domains.</li>
	<li>On the Domains Home page, click on <strong>Tools</strong>, and then select the <strong>Directory Sync</strong>&nbsp;tab.</li>
</ol>

<p>&nbsp; &nbsp; &nbsp; &nbsp;The Directory Sync installers are listed at the bottom of the page.</p>

<p>Choose the appropriate installer, based on either 32 or 64 bit platforms.</p>

<ul>
	<li><strong>Directory Sync Service x64.msi</strong></li>
	<li><strong>Directory Sync Service x86.msi</strong></li>
</ul>

<h3>Administrator’s guide</h3>

<p>To learn more about the features of the Directory Sync and how to use it after installation, see the <a href="http://www.rackspace.com/knowledge_center/article/rackspace-directory-sync-administrators-guide">Rackspace Directory Sync Administrator's Guide</a>.</p>

<h2>Install the Directory Sync service</h2>

<p>Two services are installed with the Directory Sync system, the Directory Sync service and the Password Handler service. The Directory Sync service is a Windows service that automatically synchronizes user information and requires a local service account under which to run. The Password service automatically synchronizes user password changes.</p>

<p><strong>Note: The Directory Sync service runs as the Local System account on the domain controller.</strong></p>

<p>Copy the appropriate platform-specific Directory Sync service <strong>.msi</strong>&nbsp;file to the domain controller. Then, open the file and follow the prompts for installing the Directory Sync service.</p>

<ol>
	<li>On the Welcome page of the Directory Sync Service Setup Wizard, click&nbsp;<strong>Next</strong>.</li>
	<li>On the Ready install Directory Sync Service page, click&nbsp;<strong>Install</strong>.</li>
	<li>When prompted, click <strong>Yes</strong>&nbsp;to restart your system now, or click&nbsp;<strong>No</strong>&nbsp;to manually restart it later. You must restart for the changes to take effect. After you restart, the installation wizard continues.</li>
	<li>On the Resuming the Directory Sync Service Setup Wizard page, click <strong>Install</strong>.</li>
	<li>To complete the install process, click <strong>Finish</strong>.</li>
	<li>When installation is complete, the web user interface (UI) for validation and synchronization automatically opens. A shortcut to the web UI is created on both the Start menu and on the desktop.&nbsp;</li>
</ol>

<h3>Configure the Directory Sync service and synchronize</h3>

<p>The Windows Services management console contains a new service called Directory Sync. The installation automatically starts the service.&nbsp;If any errors occur when the service is starting, view the event log for more information about the error.</p>

<p><strong>Note:&nbsp;</strong>We recommend creating new security groups in Active Directory that will manage the list of synchronized users for each hosted service. For example, if you are synchronizing Exchange users, create a new security group in Active Directory as Rackspace Exchange or Rackspace Hosted Exchange.</p>

<p>To start synchronizing Active Directory changes with Rackspace, the Directory Sync service must be configured. Perform the following steps:</p>

<ol>
	<li>Open the Directory Sync service administrative web application, if it is not already open:
	<p><img alt="" class="image-full_width" height="322" src="/knowledge_center/sites/default/files/styles/full_width/public/field/image/Installer6.png" width="700" /></p>
	</li>
	<li>On the<strong> Sync Registration Page</strong>, enter the admin ID and password associated with your Rackspace Cloud Office account, and then click <strong>Register</strong>.
	<ul>
		<li>Customers who logged in to <a href="my.rackspace.com" target="_blank">my.rackspace.com</a> will automatically create an admin ID through the MyRackspace Customer Portal before download</li>
		<li>Customers who logged in to <a href="cp.rackspace.com" target="_blank">cp.rackspace.com</a> are advised to create a new admin ID dedicated to the sync service.</li>
	</ul>
	</li>
	<li>On the&nbsp;<strong>Settings</strong> tab, provide the following information:
	<ul>
		<li><strong>Local AD Domain</strong>: Verify that the appropriate local Active Directory domain is selected.</li>
		<li><strong>Hosted Exchange</strong>: Select the appropriate security group to be synchronized with Microsoft Exchange mailboxes.</li>
		<li><strong>Hosted Email</strong>: Select the appropriate security group to be synchronized with Rackspace Email mailboxes.</li>
		<li><strong>Administrator email</strong>: Enter an email address. All alerts will be sent to this email address.</li>
		<li><strong>Time to Send Summary Email</strong>: Set the time when a summary report of changes synchronized with your Active Directory will be sent to the Administrator email address. &nbsp;By default, this value is set to 08:00.</li>
	</ul>

	<p><img alt="" class="image-full_width" height="537" src="/knowledge_center/sites/default/files/styles/full_width/public/field/image/Installer7.png" width="700" /></p>
	</li>
	<li>Click <strong>Save &amp; Start Sync</strong> to begin a full synchronization.
	<p>There are two types of synchronization:</p>

	<ul>
		<li><strong>Full synchronization</strong> finds all items available for synchronization in the entire directory. This synchronization type initiates only on the first synchronization process.</li>
		<li><strong>Delta synchronization</strong>finds changes available for synchronization in Active Directory that occurred since the last synchronization. This synchronization type runs automatically every 5 minutes by default but can also be performed manually. To manually run a delta synchronization, click on the <strong>Sync History</strong> tab and then click the <strong>Sync Now</strong> button.</li>
	</ul>
	</li>
</ol>

<p><strong>Note:</strong> The Directory Sync services never makes changes to the directory. All access is read-only.</p>

<h2><strong>Synchronize users and groups</strong></h2>

<p>For information about how to start synchronizing your Active Directory objects to your mailboxes and distribution lists, see the <a href="http://www.rackspace.com/knowledge_center/article/rackspace-directory-sync-operation-guide" title="Directory Sync Operations Guide">Directory Sync Operations Guide</a>.</p>

<h2>Install Password Synchronization for multiple domain controllers (optional)</h2>

<p>The main installer for Directory Sync is installed on one domain controller (DC) that will communicate directly to Rackspace. The DC communicates through the Rackspace API to the Cloud Office Control Panel over an HTTPS connection on port 443. This DC, or primary DC, includes the Directory Sync UI and is where Directory Sync is configured.</p>

<p>If you have multiple DCs to manage the Active Directory, you must install the Password Handler on all DCs except the primary DC (the Password Handler is installed during initial setup). Normally, password changes in a network occur locally and then are replicated to the other DCs. Directory Sync is unable to see those password changes after replication because of encryption. To ensure that password changes are synchronized, each DC requires the Password Handler to be installed directly. This installation requires each DC to restart.</p>

<p>Password changes made in the other DCs are delivered to the primary DC over port 8732. Multiple DCs communicate internally with the primary DC and do not send any password changes outside of the network. All password synchronizations are funneled through the primary DC and then synchronized to Rackspace.</p>

<p>The following figure illustrates this communication process.</p>

<p><img alt="" height="499" src="/knowledge_center/sites/default/files/field/image/Multiple%20DC%20sync.PNG" width="1048" /></p>

<h3>Install Password Handler on secondary DCs</h3>

<p>During the Installation of the Directory Sync service on the primary DC, the <strong>Directory Sync Password Handler Install</strong> folder was created on the desktop. Use the installer in this folder to synchronize your users’ passwords across multiple domain controllers.</p>

<p><strong>Note:</strong> the <strong>.msi</strong> file within the folder should be installed on the secondary domain controllers only.</p>

<p><img alt="" height="393" src="/knowledge_center/sites/default/files/field/image/Installer8_0.png" width="563" /></p>

<p>This process applies to multiple domain controllers (two or more). Repeat the following steps for each additional domain controller in the Active Directory forest.</p>

<p><strong>Important:</strong> You must restart each domain controller to complete this process. Consider performing these steps during off hours</p>

<ol>
	<li>Copy the <strong>.msi</strong> file to the secondary domain controller.</li>
	<li>Double-click the installation file and click <strong>Next</strong> on the welcome page of the wizard.</li>
	<li>On the next page, click <strong>Install</strong>.
	<p>After restart the installer will start up to finish the installation.</p>
	</li>
	<li>Click <strong>InstallFinish</strong>.</li>
</ol>

<p>The Password Handler of Directory Sync is installed.</p>

<p><strong>Note:</strong> This application runs in background. You do not have to configure any settings. Settings are taken from the primary DC.</p>

<p>Now that the installation is complete, see the <a href="/knowledge_center/article/rackspace-directory-sync-administrators-guide">Rackspace Directory Sync Administrator's Guide</a> and the <a href="/knowledge_center/article/rackspace-directory-sync-operation-guide" title="Directory Sync Operations Guide">Directory Sync Operations Guide</a> to learn how to use Directory Sync and its features.</p>
